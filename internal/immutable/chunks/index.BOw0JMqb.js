var Y=Object.defineProperty;var Z=(t,e,n)=>e in t?Y(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var b=(t,e,n)=>Z(t,typeof e!="symbol"?e+"":e,n);import{M as ee,i as te,a as ne,p as re,g as z}from"./util.BKKmp01Z.js";import{g as ie,a as se}from"./localAccess.CNYJS0uA.js";import{l as oe}from"./localstorageWritable.DviM0pTl.js";import{e as ae}from"./scheduler.Bu9aYH8f.js";function ce(t){return t[3]|t[2]<<8|t[1]<<16|t[0]<<24}const de="HTTP-WEBRTC",he="1.0",le=`${de}/${he}`,ue=6e4,x=13,N=10;function R(t,e,n){const r=t.encode(n);return B(e,r)}function B(t,e){const n=new Uint8Array(t.length+e.length);return n.set(t),n.set(e,t.length),n}function M(){return Math.random()*ee|0}function fe(t){const e=new Response(t.stream.readable,{status:t.status,statusText:t.statusText,headers:t.headers,duplex:"half"});return Object.defineProperty(e,"url",{value:`webrtc-http:${t.url.pathname}${t.url.search}`}),e}function we(t){const e=new Map,n=new TextEncoder,r=new TextDecoder;function i(o,s,l,f){const u=new TransformStream,m={connectionId:o,url:new URL(s.url),handled:!1,readStatus:!1,readHeaders:!1,headers:new Headers,status:200,statusText:"",stream:u,writer:u.writable.getWriter(),handle(d,v){if(m.handled){f(new TypeError("Response already handled"));return}m.handled=!0,d?f(d):v?l(v):f(new TypeError("No response"))}};return m.timeoutId=setTimeout(()=>m.handle(new TypeError("Request timed out")),ue),m}function a(o,s,l){let f=M();for(;e.has(f);)f=M();const u=i(f,o,s,l);return e.set(f,u),u}async function p(o,s){const l=new URL(s.url),f=te(new Uint8Array(4),o);if(t.send(R(n,f,`${s.method} ${l.pathname+l.search} ${le}`)),s.headers.forEach((u,m)=>{t.send(R(n,f,`${m}: ${u}`))}),t.send(R(n,f,`\r
`)),s.body){const u=s.body.getReader();for(;;){const{done:m,value:d}=await u.read();if(d&&t.send(B(f,d)),m)break}}t.send(R(n,f,`\r
`))}async function w(o,s){const l=e.get(o);if(l)if(l.readStatus)if(l.readHeaders)await l.writer.ready,s[0]===x&&s[1]===N?(e.delete(o),clearTimeout(l.timeoutId),l.timeoutId=void 0,await l.writer.close()):await l.writer.write(s);else if(s[0]===x&&s[1]===N)l.readHeaders=!0,l.handle(void 0,fe(l));else{const[f,u]=r.decode(s).split(/\:\s+/);l.headers.append(f,u)}else{l.readStatus=!0;const[f,u,m]=r.decode(s).split(/\s+/,3);l.status=Number.parseInt(u),l.statusText=m}}async function h(o){const s=new Uint8Array(o.data),l=ce(s);await w(l,s.slice(4))}t.addEventListener("message",h);function c(o,s){return new Promise((l,f)=>{const u=new Request(o,s),m=a(u,l,f);p(m.connectionId,u)})}return c.destroy=()=>t.removeEventListener("message",h),c}var y=[];for(var D=0;D<256;++D)y.push((D+256).toString(16).slice(1));function pe(t,e=0){return(y[t[e+0]]+y[t[e+1]]+y[t[e+2]]+y[t[e+3]]+"-"+y[t[e+4]]+y[t[e+5]]+"-"+y[t[e+6]]+y[t[e+7]]+"-"+y[t[e+8]]+y[t[e+9]]+"-"+y[t[e+10]]+y[t[e+11]]+y[t[e+12]]+y[t[e+13]]+y[t[e+14]]+y[t[e+15]]).toLowerCase()}var I,me=new Uint8Array(16);function ge(){if(!I&&(I=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!I))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return I(me)}var ye=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const q={randomUUID:ye};function U(t,e,n){if(q.randomUUID&&!e&&!t)return q.randomUUID();t=t||{};var r=t.random||(t.rng||ge)();return r[6]=r[6]&15|64,r[8]=r[8]&63|128,pe(r)}function ve(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var J={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function i(h,c,o){this.fn=h,this.context=c,this.once=o||!1}function a(h,c,o,s,l){if(typeof o!="function")throw new TypeError("The listener must be a function");var f=new i(o,s||h,l),u=n?n+c:c;return h._events[u]?h._events[u].fn?h._events[u]=[h._events[u],f]:h._events[u].push(f):(h._events[u]=f,h._eventsCount++),h}function p(h,c){--h._eventsCount===0?h._events=new r:delete h._events[c]}function w(){this._events=new r,this._eventsCount=0}w.prototype.eventNames=function(){var c=[],o,s;if(this._eventsCount===0)return c;for(s in o=this._events)e.call(o,s)&&c.push(n?s.slice(1):s);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(o)):c},w.prototype.listeners=function(c){var o=n?n+c:c,s=this._events[o];if(!s)return[];if(s.fn)return[s.fn];for(var l=0,f=s.length,u=new Array(f);l<f;l++)u[l]=s[l].fn;return u},w.prototype.listenerCount=function(c){var o=n?n+c:c,s=this._events[o];return s?s.fn?1:s.length:0},w.prototype.emit=function(c,o,s,l,f,u){var m=n?n+c:c;if(!this._events[m])return!1;var d=this._events[m],v=arguments.length,C,g;if(d.fn){switch(d.once&&this.removeListener(c,d.fn,void 0,!0),v){case 1:return d.fn.call(d.context),!0;case 2:return d.fn.call(d.context,o),!0;case 3:return d.fn.call(d.context,o,s),!0;case 4:return d.fn.call(d.context,o,s,l),!0;case 5:return d.fn.call(d.context,o,s,l,f),!0;case 6:return d.fn.call(d.context,o,s,l,f,u),!0}for(g=1,C=new Array(v-1);g<v;g++)C[g-1]=arguments[g];d.fn.apply(d.context,C)}else{var j=d.length,E;for(g=0;g<j;g++)switch(d[g].once&&this.removeListener(c,d[g].fn,void 0,!0),v){case 1:d[g].fn.call(d[g].context);break;case 2:d[g].fn.call(d[g].context,o);break;case 3:d[g].fn.call(d[g].context,o,s);break;case 4:d[g].fn.call(d[g].context,o,s,l);break;default:if(!C)for(E=1,C=new Array(v-1);E<v;E++)C[E-1]=arguments[E];d[g].fn.apply(d[g].context,C)}}return!0},w.prototype.on=function(c,o,s){return a(this,c,o,s,!1)},w.prototype.once=function(c,o,s){return a(this,c,o,s,!0)},w.prototype.removeListener=function(c,o,s,l){var f=n?n+c:c;if(!this._events[f])return this;if(!o)return p(this,f),this;var u=this._events[f];if(u.fn)u.fn===o&&(!l||u.once)&&(!s||u.context===s)&&p(this,f);else{for(var m=0,d=[],v=u.length;m<v;m++)(u[m].fn!==o||l&&!u[m].once||s&&u[m].context!==s)&&d.push(u[m]);d.length?this._events[f]=d.length===1?d[0]:d:p(this,f)}return this},w.prototype.removeAllListeners=function(c){var o;return c?(o=n?n+c:c,this._events[o]&&p(this,o)):(this._events=new r,this._eventsCount=0),this},w.prototype.off=w.prototype.removeListener,w.prototype.addListener=w.prototype.on,w.prefixed=n,w.EventEmitter=w,t.exports=w})(J);var Ce=J.exports;const H=ve(Ce),be=16384,Ee={RTCPeerConnection:typeof RTCPeerConnection>"u"?null:RTCPeerConnection,RTCSessionDescription:typeof RTCSessionDescription>"u"?null:RTCSessionDescription,RTCIceCandidate:typeof RTCIceCandidate>"u"?null:RTCIceCandidate};class Te extends H{constructor(e){super(),this.initiator=!1,this.maxChannelMessageSize=be,this.trickle=!0,this.sdpTransform=Se,this.config={iceServers:[]},this.pendingCandidates=[],this.webrtc=Ee,this.runningNegotiation=!1,this.id=e.id||U(),this.channelName=e.channelName||U(),e.channelConfig&&(this.channelConfig=e.channelConfig),e.trickle===!1&&(this.trickle=!1),e.sdpTransform&&(this.sdpTransform=e.sdpTransform),e.config&&(this.config=e.config),e.offerConfig&&(this.offerConfig=e.offerConfig),e.answerConfig&&(this.answerConfig=e.answerConfig),e.maxChannelMessageSize&&e.maxChannelMessageSize>0&&(this.maxChannelMessageSize=e.maxChannelMessageSize),e.webrtc&&(this.webrtc=e.webrtc)}getId(){return this.id}getConnection(){return this.connection}getChannel(){return this.channel}isReady(){return this.channel&&this.channel.readyState==="open"}isClosed(){return!this.connection||this.connection.connectionState!=="connected"}ready(){return this.isReady()?Promise.resolve():this.waitOnce("connect")}isInitiator(){return this.initiator}init(){return this.initiator=!0,this.createPeer(),this.needsNegotiation()}close(){return this.internalClose(!0)}send(e){if(!this.channel)throw new Error("Channel not initialized");return this.channel.send(e),this}write(e){if(!this.channel)throw new Error("Channel not initialized");return K(this.channel,e,this.maxChannelMessageSize)}writableStream(){if(!this.channel)throw new Error("Channel not initialized");return Ae(this.channel,this.maxChannelMessageSize)}readableStream(){if(!this.channel)throw new Error("Channel not initialized");return Oe(this.channel)}async signal(e){var n,r;switch(this.connection||await this.createPeer(),console.debug(`${this.id}: received signal message=${e.type}`),e.type){case"renegotiate":return this.needsNegotiation();case"transceiverRequest":{if(!this.initiator)throw new Error("Invalid signal state");const i=e.transceiverRequest;if(!i)throw new Error("Invalid signal message");return await this.addTransceiverFromKind(i.kind,i.init),this}case"candidate":{if(!this.connection)throw new Error("Connection not initialized");const i=e.candidate;if(!i)throw new Error("Invalid signal message");const a=new this.webrtc.RTCIceCandidate(i);return this.connection.remoteDescription==null?this.pendingCandidates.push(a):await this.connection.addIceCandidate(a),this}case"answer":case"offer":case"pranswer":case"rollback":{if(!this.connection)throw new Error("Connection not initialized");const i=e.sdp;if(!i)throw new Error("Invalid signal message");const a=new this.webrtc.RTCSessionDescription({type:e.type,sdp:i});console.debug(`${this.id}: setting remote sdp`),await this.connection.setRemoteDescription(a);for(const p of this.pendingCandidates)await this.connection.addIceCandidate(p);return this.pendingCandidates.length=0,((r=(n=this.connection)===null||n===void 0?void 0:n.remoteDescription)===null||r===void 0?void 0:r.type)==="offer"&&await this.createAnswer(),this}default:throw console.debug(`${this.id}: invalid signal type: ${e}`),new Error("Invalid signal message type")}}waitOnce(e){return new Promise(n=>{this.once(e,(...r)=>{switch(r.length){case 0:n(void 0);break;case 1:n(r[0]);break;default:n(r);break}})})}addTransceiverFromKind(e,n){if(!this.connection)throw new Error("Connection not initialized");if(this.initiator){const r=this.connection.addTransceiver(e,n);return this.emit("transceiver",r),this.needsNegotiation(),r}return this.internalSignal({type:"transceiverRequest",transceiverRequest:{kind:e,init:n}}),null}addTrack(e){if(!this.connection)throw new Error("Connection not initialized");const n=this.connection.addTrack(e);return this.needsNegotiation(),n}removeTrack(e){if(!this.connection)throw new Error("Connection not initialized");return this.connection.removeTrack(e),this.needsNegotiation(),this}internalSignal(e){return this.emit("signal",e),this}async needsNegotiation(){if(!this.connection)throw new Error("Connection not initialized");if(this.initiator&&!this.runningNegotiation)try{this.runningNegotiation=!0,await Re(),await this.negotiate()}finally{this.runningNegotiation=!1}return this}async negotiate(){if(!this.connection)throw new Error("Connection not initialized");return this.initiator?(await Ie(0),await this.createOffer()):this.internalSignal({type:"renegotiate",renegotiate:!0}),this}async createOffer(){if(!this.connection)throw new Error("Connection not initialized");const e=await this.connection.createOffer(this.offerConfig);return this.trickle||(e.sdp=$(e.sdp)),e.sdp=this.sdpTransform(e.sdp),await this.connection.setLocalDescription(e),this.internalSignal({type:e.type,sdp:e.sdp}),this}async createAnswer(){if(!this.connection)throw new Error("Connection not initialized");const e=await this.connection.createAnswer(this.answerConfig);return this.trickle||(e.sdp=$(e.sdp)),e.sdp=this.sdpTransform(e.sdp),await this.connection.setLocalDescription(e),this.internalSignal({type:e.type,sdp:e.sdp}),this}createPeer(){if(this.internalClose(!1),this.connection=new this.webrtc.RTCPeerConnection(this.config),this.connection.addEventListener("connectionstatechange",this.onConnectionStateChange.bind(this)),this.connection.addEventListener("icecandidate",this.onICECandidate.bind(this)),this.connection.addEventListener("track",this.onTrackRemote.bind(this)),this.initiator){const e=this.connection.createDataChannel(this.channelName,this.channelConfig);e.addEventListener("open",this.onDataChannelOpen.bind(this)),e.addEventListener("message",this.onDataChannelMessage.bind(this)),e.addEventListener("error",this.onDataChannelError.bind(this)),this.channel=e}else this.connection.addEventListener("datachannel",this.onDataChannel.bind(this));return this}internalClose(e=!0){return this.channel&&(this.channel.close(),this.channel=void 0),this.connection&&(this.connection.close(),this.connection=void 0),e&&this.emit("close"),this}onConnectionStateChange(){if(this.connection)switch(this.connection.connectionState){case"connected":break;case"failed":case"disconnected":case"closed":this.internalClose(!0);break}}onICECandidate(e){e.candidate&&this.internalSignal({type:"candidate",candidate:e.candidate})}onTrackRemote(e){this.emit("track",e)}onDataChannel(e){const n=e.channel;this.channel=n,this.channel.onopen=this.onDataChannelOpen.bind(this),this.channel.onmessage=this.onDataChannelMessage.bind(this),this.channel.onerror=this.onDataChannelError.bind(this)}onDataChannelOpen(){console.debug(`${this.id}: data channel open`),this.emit("connect")}onDataChannelMessage(e){this.emit("data",e.data)}onDataChannelError(e){this.emit("error",new Error("DataChannel error",{cause:e}))}}function $(t){return t==null?void 0:t.replace(/a=ice-options:trickle\s\n/g,"")}function Se(t){return t}function Re(){return new Promise(t=>t())}function Ie(t){return new Promise(e=>setTimeout(e,t))}function K(t,e,n){if(typeof e=="string")if(e.length<n)t.send(e);else{let r=0;for(;r<e.length;){const i=Math.min(n,e.length-r);t.send(e.substring(r,r+i)),r+=i}}else if(e instanceof Blob)if(e.size<n)t.send(e);else{let r=0;for(;r<e.size;){const i=Math.min(n,e.size-r);t.send(e.slice(r,r+i)),r+=i}}else{let r;if(e instanceof ArrayBuffer?r=e:r=e.buffer,r.byteLength<n)t.send(r);else{let i=0;for(;i<r.byteLength;){const a=Math.min(n,r.byteLength-i);t.send(r.slice(i,i+a)),i+=a}}}}function Ae(t,e){return new WritableStream({write(n){K(t,n,e)}})}function Oe(t){let e=!1,n=!1;const r=[],i=[];function a(){return new Promise((h,c)=>i.push([h,c]))}function p(h){if(i.length){const[c,o]=i.shift();c(h.data)}else r.push(h.data)}t.addEventListener("message",p);const w=()=>{if(!e){t.removeEventListener("message",p),t.removeEventListener("close",w),e=!0;for(const[h,c]of i)c(new Error("Stream closed"));i.length=0,r.length=0}};return t.addEventListener("close",w),new ReadableStream({async pull(h){if(e){n||(n=!0,h.close());return}r.length?h.enqueue(r.shift()):h.enqueue(await a())},cancel:w})}class Pe extends H{constructor(e){super(),this.connected=!1,this.connecting=!1,this.reconnecting=!1,this.closed=!1,this.connectTime=Date.now(),this.minTimeBetweenReconnectsMS=0,this.url=e.url,e.WebSocket?this.WebSocket=e.WebSocket:this.WebSocket=WebSocket,e.minTimeBetweenReconnectsMS&&(this.minTimeBetweenReconnectsMS=e.minTimeBetweenReconnectsMS),e.autoconnect&&this.connect()}send(e){var n;if(!this.connected)throw new Error("WebSocket not ready");return(n=this.websocket)===null||n===void 0||n.send(e),this}ready(){return this.connected?Promise.resolve():this.waitOnce("open")}waitOnce(e){return new Promise(n=>{this.once(e,(...r)=>{switch(r.length){case 0:n(void 0);break;case 1:n(r[0]);break;default:n(r);break}})})}close(e,n){this.connected=!1,this.connecting=!1,this.closed=!0,this.websocket?this.websocket.close(e,n):this.emit("close")}async connect(){if(this.connected)return this;if(this.connecting)return this;this.connecting=!0;try{this.connectTime=Date.now();const e=new this.WebSocket(await this.url()),n=()=>{e.removeEventListener("open",n),this.connected=!0,this.emit("open")};e.addEventListener("open",n),e.addEventListener("close",()=>{this.websocket=void 0,this.connected=!1,this.closed?this.emit("close"):(this.emit("disconnect"),this.reconnect())}),e.addEventListener("message",r=>{this.emit("message",r.data)}),e.addEventListener("error",()=>{this.emit("error")}),this.websocket=e}catch(e){this.emit("error",e)}finally{this.connecting=!1}return this}reconnect(){if(this.reconnecting)return this;this.reconnecting=!0;try{const e=Date.now()-this.connectTime;e<this.minTimeBetweenReconnectsMS?setTimeout(()=>{this.connect()},this.minTimeBetweenReconnectsMS-e):this.connect()}finally{this.reconnecting=!1}return this}}const k=new Map,T=new Pe({url:_e});T.on("message",t=>{const e=JSON.parse(t),n=k.get(e.peerId);n&&n.signal(e.message)});let A;function De(){if(A)return A;{let t;return A=(e,n)=>(t||(t=Le("webrtchttp").then(r=>(r.on("close",()=>{t=void 0}),we(r.getChannel())))),t.then(r=>r(e,n))),A}}function Le(t){return T.connect(),new Promise((e,n)=>{const r=new Te({trickle:!0,channelConfig:{ordered:!0}});r.on("error",w=>console.error(w)),r.on("signal",w=>{T.send(JSON.stringify({type:"signal",peerId:r.getId(),message:w}))});function i(){r.off("connect",a),r.off("close",p)}function a(){i(),e(r)}function p(){i(),n()}r.on("connect",a),r.on("close",p),T.ready().then(()=>{T.send(JSON.stringify({type:"init",peerId:r.getId(),peerType:t}))},p),r.on("close",()=>{k.delete(r.getId())}),k.set(r.getId(),r)})}async function _e(){const t=ie();if(!t)throw new Error("No remote access configured");const e=await ke(t);return`${ne(t.host,t.ssl)}/client/websocket?token=${e}`}let L,_;async function ke(t){return(!_||_<=Date.now())&&(L=await xe(t),_=re(L).exp*1e3),L}async function xe(t){const e={id:t.id,password:t.password},n={"Content-Type":"application/json"},r=await fetch(`${z(t.host,t.ssl)}/client`,{method:"POST",headers:n,credentials:"same-origin",mode:"cors",body:JSON.stringify(e)});if(r.status>=400)throw new Error("failed to authenticate");return await r.text()}const Ne=oe("access","local");function F(){return ae(Ne)}const Me="http://localhost:3000".replace(/\/+$/,"");class V{constructor(e={}){this.configuration=e}set config(e){this.configuration=e}get basePath(){return this.configuration.basePath!=null?this.configuration.basePath:Me}get fetchApi(){return this.configuration.fetchApi}get middleware(){return this.configuration.middleware||[]}get queryParamsStringify(){return this.configuration.queryParamsStringify||G}get username(){return this.configuration.username}get password(){return this.configuration.password}get apiKey(){const e=this.configuration.apiKey;if(e)return typeof e=="function"?e:()=>e}get accessToken(){const e=this.configuration.accessToken;if(e)return typeof e=="function"?e:async()=>e}get headers(){return this.configuration.headers}get credentials(){return this.configuration.credentials}}const qe=new V,P=class P{constructor(e=qe){b(this,"middleware");b(this,"fetchApi",async(e,n)=>{let r={url:e,init:n};for(const a of this.middleware)a.pre&&(r=await a.pre({fetch:this.fetchApi,...r})||r);let i;try{i=await(this.configuration.fetchApi||fetch)(r.url,r.init)}catch(a){for(const p of this.middleware)p.onError&&(i=await p.onError({fetch:this.fetchApi,url:r.url,init:r.init,error:a,response:i?i.clone():void 0})||i);if(i===void 0)throw a instanceof Error?new We(a,"The request failed and the interceptors did not return an alternative response"):a}for(const a of this.middleware)a.post&&(i=await a.post({fetch:this.fetchApi,url:r.url,init:r.init,response:i.clone()})||i);return i});this.configuration=e,this.middleware=e.middleware}withMiddleware(...e){const n=this.clone();return n.middleware=n.middleware.concat(...e),n}withPreMiddleware(...e){const n=e.map(r=>({pre:r}));return this.withMiddleware(...n)}withPostMiddleware(...e){const n=e.map(r=>({post:r}));return this.withMiddleware(...n)}isJsonMime(e){return e?P.jsonRegex.test(e):!1}async request(e,n){const{url:r,init:i}=await this.createFetchParams(e,n),a=await this.fetchApi(r,i);if(a&&a.status>=200&&a.status<300)return a;throw new Fe(a,"Response returned an error code")}async createFetchParams(e,n){let r=this.configuration.basePath+e.path;e.query!==void 0&&Object.keys(e.query).length!==0&&(r+="?"+this.configuration.queryParamsStringify(e.query));const i=Object.assign({},this.configuration.headers,e.headers);Object.keys(i).forEach(o=>i[o]===void 0?delete i[o]:{});const a=typeof n=="function"?n:async()=>n,p={method:e.method,headers:i,body:e.body,credentials:this.configuration.credentials},w={...p,...await a({init:p,context:e})};let h;$e(w.body)||w.body instanceof URLSearchParams||Ue(w.body)?h=w.body:this.isJsonMime(i["Content-Type"])?h=JSON.stringify(w.body):h=w.body;const c={...w,body:h};return{url:r,init:c}}clone(){const e=this.constructor,n=new e(this.configuration);return n.middleware=this.middleware.slice(),n}};b(P,"jsonRegex",new RegExp("^(:?application/json|[^;/ 	]+/[^;/ 	]+[+]json)[ 	]*(:?;.*)?$","i"));let O=P;function Ue(t){return typeof Blob<"u"&&t instanceof Blob}function $e(t){return typeof FormData<"u"&&t instanceof FormData}class Fe extends Error{constructor(n,r){super(r);b(this,"name","ResponseError");this.response=n}}class We extends Error{constructor(n,r){super(r);b(this,"name","FetchError");this.cause=n}}class ze extends Error{constructor(n,r){super(r);b(this,"name","RequiredError");this.field=n}}function G(t,e=""){return Object.keys(t).map(n=>Q(n,t[n],e)).filter(n=>n.length>0).join("&")}function Q(t,e,n=""){const r=n+(n.length?`[${t}]`:t);if(e instanceof Array){const i=e.map(a=>encodeURIComponent(String(a))).join(`&${encodeURIComponent(r)}=`);return`${encodeURIComponent(r)}=${i}`}if(e instanceof Set){const i=Array.from(e);return Q(t,i,n)}return e instanceof Date?`${encodeURIComponent(r)}=${encodeURIComponent(e.toISOString())}`:e instanceof Object?G(e,r):`${encodeURIComponent(r)}=${encodeURIComponent(String(e))}`}class S{constructor(e,n=r=>r){this.raw=e,this.transformer=n}async value(){return this.transformer(await this.raw.json())}}function W(t){return Be(t)}function Be(t,e){return t==null?t:{createdAt:t.createdAt==null?void 0:new Date(t.createdAt),hardwareId:t.hardwareId,id:t.id,mediaUris:t.mediaUris,name:t.name,updatedAt:new Date(t.updatedAt)}}function Je(t){return He(t)}function He(t,e){return t==null?t:{date:new Date(t.date)}}function Ke(t){return Ve(t)}function Ve(t,e){return t==null?t:{host:t.host,id:t.id,password:t.password,ssl:t.ssl}}function Ge(t){return Qe(t)}function Qe(t,e){return t==null?t:{build:t.build,version:t.version}}class Xe extends O{async healthCheckRaw(e){const n={},r={},i=await this.request({path:"/health",method:"GET",headers:r,query:n},e);return new S(i,a=>Je(a))}async healthCheck(e){return await(await this.healthCheckRaw(e)).value()}async remoteAccessRaw(e){const n={},r={},i=await this.request({path:"/remote-access",method:"GET",headers:r,query:n},e);return new S(i,a=>Ke(a))}async remoteAccess(e){return await(await this.remoteAccessRaw(e)).value()}async versionRaw(e){const n={},r={},i=await this.request({path:"/version",method:"GET",headers:r,query:n},e);return new S(i,a=>Ge(a))}async version(e){return await(await this.versionRaw(e)).value()}}class je extends O{async cameraByHardwareIdRaw(e,n){if(e.hardwareId==null)throw new ze("hardwareId",'Required parameter "hardwareId" was null or undefined when calling cameraByHardwareId().');const r={},i={},a=await this.request({path:"/cameras/{hardwareId}".replace("{hardwareId}",encodeURIComponent(String(e.hardwareId))),method:"GET",headers:i,query:r},n);return new S(a,p=>W(p))}async cameraByHardwareId(e,n){return await(await this.cameraByHardwareIdRaw({hardwareId:e},n)).value()}async camerasRaw(e){const n={},r={},i=await this.request({path:"/cameras",method:"GET",headers:r,query:n},e);return new S(i,a=>a.map(W))}async cameras(e){return await(await this.camerasRaw(e)).value()}}const Ye={middleware:[{pre:async t=>({...t,init:{...t.init,mode:"cors"}})}],apiKey(t){switch(t){default:return""}},credentials:"same-origin",get fetchApi(){return F()==="remote"?De():fetch},get basePath(){if(F()==="local"){const e=se();if(e)return z(e.host,e.ssl)}return""}},X=new V(Ye);new Xe(X);const it=new je(X);export{Xe as A,V as C,Fe as R,Le as a,xe as b,it as c,Ye as d,Ne as e};
