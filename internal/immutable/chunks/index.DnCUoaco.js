var Y=Object.defineProperty;var Z=(t,e,n)=>e in t?Y(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var b=(t,e,n)=>Z(t,typeof e!="symbol"?e+"":e,n);import{M as ee,i as te,a as ne,p as ie,g as B}from"./util.BKKmp01Z.js";import{g as re,a as se}from"./localAccess.CNYJS0uA.js";import{l as oe}from"./localstorageWritable.DviM0pTl.js";import{e as ae}from"./scheduler.Bu9aYH8f.js";function ce(t){return t[3]|t[2]<<8|t[1]<<16|t[0]<<24}const de="HTTP-WEBRTC",he="1.0",le=`${de}/${he}`,ue=6e4,x=13,$=10;function R(t,e,n){const i=t.encode(n);return J(e,i)}function J(t,e){const n=new Uint8Array(t.length+e.length);return n.set(t),n.set(e,t.length),n}function q(){return Math.random()*ee|0}function fe(t){const e=new Response(t.stream.readable,{status:t.status,statusText:t.statusText,headers:t.headers,duplex:"half"});return Object.defineProperty(e,"url",{value:`webrtc-http:${t.url.pathname}${t.url.search}`}),e}function we(t){const e=new Map,n=new TextEncoder,i=new TextDecoder;function r(o,s,l,f){const u=new TransformStream,p={connectionId:o,url:new URL(s.url),handled:!1,readStatus:!1,readHeaders:!1,headers:new Headers,status:200,statusText:"",stream:u,writer:u.writable.getWriter(),handle(d,C){if(p.handled){f(new TypeError("Response already handled"));return}p.handled=!0,d?f(d):C?l(C):f(new TypeError("No response"))}};return p.timeoutId=setTimeout(()=>p.handle(new TypeError("Request timed out")),ue),p}function a(o,s,l){let f=q();for(;e.has(f);)f=q();const u=r(f,o,s,l);return e.set(f,u),u}async function m(o,s){const l=new URL(s.url),f=te(new Uint8Array(4),o);if(t.send(R(n,f,`${s.method} ${l.pathname+l.search} ${le}`)),s.headers.forEach((u,p)=>{t.send(R(n,f,`${p}: ${u}`))}),t.send(R(n,f,`\r
`)),s.body){const u=s.body.getReader();for(;;){const{done:p,value:d}=await u.read();if(d&&t.send(J(f,d)),p)break}}t.send(R(n,f,`\r
`))}async function w(o,s){const l=e.get(o);if(l)if(l.readStatus)if(l.readHeaders)await l.writer.ready,s[0]===x&&s[1]===$?(e.delete(o),clearTimeout(l.timeoutId),l.timeoutId=void 0,await l.writer.close()):await l.writer.write(s);else if(s[0]===x&&s[1]===$)l.readHeaders=!0,l.handle(void 0,fe(l));else{const[f,u]=i.decode(s).split(/\:\s+/);l.headers.append(f,u)}else{l.readStatus=!0;const[f,u,p]=i.decode(s).split(/\s+/,3);l.status=Number.parseInt(u),l.statusText=p}}async function h(o){const s=new Uint8Array(o.data),l=ce(s);await w(l,s.slice(4))}t.addEventListener("message",h);function c(o,s){return new Promise((l,f)=>{const u=new Request(o,s),p=a(u,l,f);m(p.connectionId,u)})}return c.destroy=()=>t.removeEventListener("message",h),c}var y=[];for(var L=0;L<256;++L)y.push((L+256).toString(16).slice(1));function pe(t,e=0){return(y[t[e+0]]+y[t[e+1]]+y[t[e+2]]+y[t[e+3]]+"-"+y[t[e+4]]+y[t[e+5]]+"-"+y[t[e+6]]+y[t[e+7]]+"-"+y[t[e+8]]+y[t[e+9]]+"-"+y[t[e+10]]+y[t[e+11]]+y[t[e+12]]+y[t[e+13]]+y[t[e+14]]+y[t[e+15]]).toLowerCase()}var I,ge=new Uint8Array(16);function me(){if(!I&&(I=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!I))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return I(ge)}var ye=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const M={randomUUID:ye};function U(t,e,n){if(M.randomUUID&&!e&&!t)return M.randomUUID();t=t||{};var i=t.random||(t.rng||me)();return i[6]=i[6]&15|64,i[8]=i[8]&63|128,pe(i)}function Ce(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var z={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,n="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(n=!1));function r(h,c,o){this.fn=h,this.context=c,this.once=o||!1}function a(h,c,o,s,l){if(typeof o!="function")throw new TypeError("The listener must be a function");var f=new r(o,s||h,l),u=n?n+c:c;return h._events[u]?h._events[u].fn?h._events[u]=[h._events[u],f]:h._events[u].push(f):(h._events[u]=f,h._eventsCount++),h}function m(h,c){--h._eventsCount===0?h._events=new i:delete h._events[c]}function w(){this._events=new i,this._eventsCount=0}w.prototype.eventNames=function(){var c=[],o,s;if(this._eventsCount===0)return c;for(s in o=this._events)e.call(o,s)&&c.push(n?s.slice(1):s);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(o)):c},w.prototype.listeners=function(c){var o=n?n+c:c,s=this._events[o];if(!s)return[];if(s.fn)return[s.fn];for(var l=0,f=s.length,u=new Array(f);l<f;l++)u[l]=s[l].fn;return u},w.prototype.listenerCount=function(c){var o=n?n+c:c,s=this._events[o];return s?s.fn?1:s.length:0},w.prototype.emit=function(c,o,s,l,f,u){var p=n?n+c:c;if(!this._events[p])return!1;var d=this._events[p],C=arguments.length,v,g;if(d.fn){switch(d.once&&this.removeListener(c,d.fn,void 0,!0),C){case 1:return d.fn.call(d.context),!0;case 2:return d.fn.call(d.context,o),!0;case 3:return d.fn.call(d.context,o,s),!0;case 4:return d.fn.call(d.context,o,s,l),!0;case 5:return d.fn.call(d.context,o,s,l,f),!0;case 6:return d.fn.call(d.context,o,s,l,f,u),!0}for(g=1,v=new Array(C-1);g<C;g++)v[g-1]=arguments[g];d.fn.apply(d.context,v)}else{var j=d.length,E;for(g=0;g<j;g++)switch(d[g].once&&this.removeListener(c,d[g].fn,void 0,!0),C){case 1:d[g].fn.call(d[g].context);break;case 2:d[g].fn.call(d[g].context,o);break;case 3:d[g].fn.call(d[g].context,o,s);break;case 4:d[g].fn.call(d[g].context,o,s,l);break;default:if(!v)for(E=1,v=new Array(C-1);E<C;E++)v[E-1]=arguments[E];d[g].fn.apply(d[g].context,v)}}return!0},w.prototype.on=function(c,o,s){return a(this,c,o,s,!1)},w.prototype.once=function(c,o,s){return a(this,c,o,s,!0)},w.prototype.removeListener=function(c,o,s,l){var f=n?n+c:c;if(!this._events[f])return this;if(!o)return m(this,f),this;var u=this._events[f];if(u.fn)u.fn===o&&(!l||u.once)&&(!s||u.context===s)&&m(this,f);else{for(var p=0,d=[],C=u.length;p<C;p++)(u[p].fn!==o||l&&!u[p].once||s&&u[p].context!==s)&&d.push(u[p]);d.length?this._events[f]=d.length===1?d[0]:d:m(this,f)}return this},w.prototype.removeAllListeners=function(c){var o;return c?(o=n?n+c:c,this._events[o]&&m(this,o)):(this._events=new i,this._eventsCount=0),this},w.prototype.off=w.prototype.removeListener,w.prototype.addListener=w.prototype.on,w.prefixed=n,w.EventEmitter=w,t.exports=w})(z);var ve=z.exports;const H=Ce(ve),be=16384,Ee={RTCPeerConnection:typeof RTCPeerConnection>"u"?null:RTCPeerConnection,RTCSessionDescription:typeof RTCSessionDescription>"u"?null:RTCSessionDescription,RTCIceCandidate:typeof RTCIceCandidate>"u"?null:RTCIceCandidate};class Se extends H{constructor(e){super(),this.initiator=!1,this.maxChannelMessageSize=be,this.trickle=!0,this.sdpTransform=Te,this.config={iceServers:[]},this.pendingCandidates=[],this.webrtc=Ee,this.id=e.id||U(),this.channelName=e.channelName||U(),e.channelConfig&&(this.channelConfig=e.channelConfig),e.trickle===!1&&(this.trickle=!1),e.sdpTransform&&(this.sdpTransform=e.sdpTransform),e.config&&(this.config=e.config),e.offerConfig&&(this.offerConfig=e.offerConfig),e.answerConfig&&(this.answerConfig=e.answerConfig),e.maxChannelMessageSize&&e.maxChannelMessageSize>0&&(this.maxChannelMessageSize=e.maxChannelMessageSize),e.webrtc&&(this.webrtc=e.webrtc)}getId(){return this.id}getConnection(){return this.connection}getChannel(){return this.channel}isReady(){return this.channel&&this.channel.readyState==="open"}isClosed(){return!this.connection||this.connection.connectionState!=="connected"}ready(){return this.isReady()?Promise.resolve():this.waitOnce("connect")}isInitiator(){return this.initiator}init(){return this.initiator=!0,this.createPeer()}close(){return this.internalClose(!0)}send(e){if(!this.channel)throw new Error("Channel not initialized");return this.channel.send(e),this}write(e){if(!this.channel)throw new Error("Channel not initialized");return K(this.channel,e,this.maxChannelMessageSize)}writableStream(){if(!this.channel)throw new Error("Channel not initialized");return Re(this.channel,this.maxChannelMessageSize)}readableStream(){if(!this.channel)throw new Error("Channel not initialized");return Ie(this.channel)}async signal(e){var n,i;switch(this.connection||await this.createPeer(),console.debug(`${this.id}: received signal message=${e.type}`),e.type){case"renegotiate":return this.negotiate();case"transceiverRequest":{if(!this.initiator)throw new Error("Invalid signal state");const r=e.transceiverRequest;if(!r)throw new Error("Invalid signal message");return await this.addTransceiverFromKind(r.kind,r.init),this}case"candidate":{if(!this.connection)throw new Error("Connection not initialized");const r=e.candidate;if(!r)throw new Error("Invalid signal message");const a=new this.webrtc.RTCIceCandidate(r);return this.connection.remoteDescription==null?this.pendingCandidates.push(a):await this.connection.addIceCandidate(a),this}case"answer":case"offer":case"pranswer":case"rollback":{if(!this.connection)throw new Error("Connection not initialized");const r=e.sdp;if(!r)throw new Error("Invalid signal message");const a=new this.webrtc.RTCSessionDescription({type:e.type,sdp:r});await this.connection.setRemoteDescription(a);for(const m of this.pendingCandidates)await this.connection.addIceCandidate(m);return this.pendingCandidates.length=0,((i=(n=this.connection)===null||n===void 0?void 0:n.remoteDescription)===null||i===void 0?void 0:i.type)==="offer"&&await this.createAnswer(),this.emit("negotiated"),console.debug(`${this.id}: set remote sdp`),this}default:throw console.debug(`${this.id}: invalid signal type: ${e}`),new Error("Invalid signal message type")}}waitOnce(e){return new Promise(n=>{this.once(e,(...i)=>{switch(i.length){case 0:n(void 0);break;case 1:n(i[0]);break;default:n(i);break}})})}addTransceiverFromKind(e,n){if(!this.connection)throw new Error("Connection not initialized");if(this.initiator){const i=this.connection.addTransceiver(e,n);return this.emit("transceiver",i),i}return this.internalSignal({type:"transceiverRequest",transceiverRequest:{kind:e,init:n}}),null}addTrack(e){if(!this.connection)throw new Error("Connection not initialized");return this.connection.addTrack(e)}removeTrack(e){if(!this.connection)throw new Error("Connection not initialized");return this.connection.removeTrack(e),this}internalSignal(e){return this.emit("signal",e),this}async negotiate(){if(!this.connection)throw new Error("Connection not initialized");return this.initiator?await this.createOffer():this.internalSignal({type:"renegotiate",renegotiate:!0}),this}async createOffer(){if(!this.connection)throw new Error("Connection not initialized");const e=await this.connection.createOffer(this.offerConfig);return this.trickle||(e.sdp=N(e.sdp)),e.sdp=this.sdpTransform(e.sdp),await this.connection.setLocalDescription(e),this.internalSignal({type:e.type,sdp:e.sdp}),this}async createAnswer(){if(!this.connection)throw new Error("Connection not initialized");const e=await this.connection.createAnswer(this.answerConfig);return this.trickle||(e.sdp=N(e.sdp)),e.sdp=this.sdpTransform(e.sdp),await this.connection.setLocalDescription(e),this.internalSignal({type:e.type,sdp:e.sdp}),this}createPeer(){if(this.internalClose(!1),this.connection=new this.webrtc.RTCPeerConnection(this.config),this.connection.addEventListener("negotiationneeded",this.onNegotiationNeeded.bind(this)),this.connection.addEventListener("iceconnectionstatechange",this.onICEConnectionStateChange.bind(this)),this.connection.addEventListener("icegatheringstatechange",this.onICEGatheringStateChange.bind(this)),this.connection.addEventListener("connectionstatechange",this.onConnectionStateChange.bind(this)),this.connection.addEventListener("icecandidate",this.onICECandidate.bind(this)),this.connection.addEventListener("signalingstatechange",this.onSignalingStateChange.bind(this)),this.connection.addEventListener("track",this.onTrackRemote.bind(this)),this.initiator){const e=this.connection.createDataChannel(this.channelName,this.channelConfig);e.addEventListener("open",this.onDataChannelOpen.bind(this)),e.addEventListener("message",this.onDataChannelMessage.bind(this)),e.addEventListener("error",this.onDataChannelError.bind(this)),this.channel=e}else this.connection.addEventListener("datachannel",this.onDataChannel.bind(this));return this}internalClose(e=!0){return this.channel&&(this.channel.close(),this.channel=void 0),this.connection&&(this.connection.close(),this.connection=void 0),e&&this.emit("close"),this}onConnectionStateChange(){if(this.connection)switch(this.connection.connectionState){case"connected":console.debug(`${this.id}: connection state connected`);break;case"failed":console.debug(`${this.id}: connection state failed`),this.internalClose(!0);break;case"disconnected":console.debug(`${this.id}: connection state disconnected`),this.internalClose(!0);break;case"closed":console.debug(`${this.id}: connection state closed`),this.internalClose(!0);break}}onNegotiationNeeded(){if(this.connection)return this.negotiate()}onICEConnectionStateChange(){this.connection&&console.debug(`${this.id}: ice connection state ${this.connection.iceConnectionState}`)}onICEGatheringStateChange(){this.connection&&console.debug(`${this.id}: ice gathering state ${this.connection.iceGatheringState}`)}onSignalingStateChange(){this.connection&&console.debug(`${this.id}: signaling state ${this.connection.signalingState}`)}onICECandidate(e){e.candidate&&this.internalSignal({type:"candidate",candidate:e.candidate})}onTrackRemote(e){this.emit("track",e)}onDataChannel(e){const n=e.channel;this.channel=n,this.channel.onopen=this.onDataChannelOpen.bind(this),this.channel.onmessage=this.onDataChannelMessage.bind(this),this.channel.onerror=this.onDataChannelError.bind(this)}onDataChannelOpen(){console.debug(`${this.id}: data channel open`),this.emit("connect")}onDataChannelMessage(e){this.emit("data",e.data)}onDataChannelError(e){this.emit("error",new Error("DataChannel error",{cause:e}))}}function N(t){return t==null?void 0:t.replace(/a=ice-options:trickle\s\n/g,"")}function Te(t){return t}function K(t,e,n){if(typeof e=="string")if(e.length<n)t.send(e);else{let i=0;for(;i<e.length;){const r=Math.min(n,e.length-i);t.send(e.substring(i,i+r)),i+=r}}else if(e instanceof Blob)if(e.size<n)t.send(e);else{let i=0;for(;i<e.size;){const r=Math.min(n,e.size-i);t.send(e.slice(i,i+r)),i+=r}}else{let i;if(e instanceof ArrayBuffer?i=e:i=e.buffer,i.byteLength<n)t.send(i);else{let r=0;for(;r<i.byteLength;){const a=Math.min(n,i.byteLength-r);t.send(i.slice(r,r+a)),r+=a}}}}function Re(t,e){return new WritableStream({write(n){K(t,n,e)}})}function Ie(t){let e=!1,n=!1;const i=[],r=[];function a(){return new Promise((h,c)=>r.push([h,c]))}function m(h){if(r.length){const[c,o]=r.shift();c(h.data)}else i.push(h.data)}t.addEventListener("message",m);const w=()=>{if(!e){t.removeEventListener("message",m),t.removeEventListener("close",w),e=!0;for(const[h,c]of r)c(new Error("Stream closed"));r.length=0,i.length=0}};return t.addEventListener("close",w),new ReadableStream({async pull(h){if(e){n||(n=!0,h.close());return}i.length?h.enqueue(i.shift()):h.enqueue(await a())},cancel:w})}class Ae extends H{constructor(e){super(),this.connected=!1,this.connecting=!1,this.reconnecting=!1,this.closed=!1,this.connectTime=Date.now(),this.minTimeBetweenReconnectsMS=0,this.url=e.url,e.WebSocket?this.WebSocket=e.WebSocket:this.WebSocket=WebSocket,e.minTimeBetweenReconnectsMS&&(this.minTimeBetweenReconnectsMS=e.minTimeBetweenReconnectsMS),e.autoconnect&&this.connect()}send(e){var n;if(!this.connected)throw new Error("WebSocket not ready");return(n=this.websocket)===null||n===void 0||n.send(e),this}ready(){return this.connected?Promise.resolve():this.waitOnce("open")}waitOnce(e){return new Promise(n=>{this.once(e,(...i)=>{switch(i.length){case 0:n(void 0);break;case 1:n(i[0]);break;default:n(i);break}})})}close(e,n){this.connected=!1,this.connecting=!1,this.closed=!0,this.websocket?this.websocket.close(e,n):this.emit("close")}async connect(){if(this.connected)return this;if(this.connecting)return this;this.connecting=!0;try{this.connectTime=Date.now();const e=new this.WebSocket(await this.url()),n=()=>{e.removeEventListener("open",n),this.connected=!0,this.emit("open")};e.addEventListener("open",n),e.addEventListener("close",()=>{this.websocket=void 0,this.connected=!1,this.closed?this.emit("close"):(this.emit("disconnect"),this.reconnect())}),e.addEventListener("message",i=>{this.emit("message",i.data)}),e.addEventListener("error",()=>{this.emit("error")}),this.websocket=e}catch(e){this.emit("error",e)}finally{this.connecting=!1}return this}reconnect(){if(this.reconnecting)return this;this.reconnecting=!0;try{const e=Date.now()-this.connectTime;e<this.minTimeBetweenReconnectsMS?setTimeout(()=>{this.connect()},this.minTimeBetweenReconnectsMS-e):this.connect()}finally{this.reconnecting=!1}return this}}const k=new Map,S=new Ae({url:Le});S.on("message",t=>{const e=JSON.parse(t),n=k.get(e.peerId);n&&n.signal(e.message)});let A;function Oe(){if(A)return A;{let t;return A=(e,n)=>{if(!t){const i=De("webrtchttp");t=i.ready().then(()=>we(i.getChannel())),i.on("close",()=>{t=void 0})}return t.then(i=>i(e,n))},A}}function De(t){S.connect();const e=new Se({trickle:!0,channelConfig:{ordered:!0}});return e.on("error",n=>console.error(n)),e.on("signal",n=>{S.send(JSON.stringify({type:"signal",peerId:e.getId(),message:n}))}),S.ready().then(()=>{S.send(JSON.stringify({type:"init",peerId:e.getId(),peerType:t}))}),e.on("close",()=>{k.delete(e.getId())}),k.set(e.getId(),e),e}async function Le(){const t=re();if(!t)throw new Error("No remote access configured");const e=await Pe(t);return`${ne(t.host,t.ssl)}/client/websocket?token=${e}`}let P,_;async function Pe(t){return(!_||_<=Date.now())&&(P=await _e(t),_=ie(P).exp*1e3),P}async function _e(t){const e={id:t.id,password:t.password},n={"Content-Type":"application/json"},i=await fetch(`${B(t.host,t.ssl)}/client`,{method:"POST",headers:n,credentials:"same-origin",mode:"cors",body:JSON.stringify(e)});if(i.status>=400)throw new Error("failed to authenticate");return await i.text()}const ke=oe("access","local");function F(){return ae(ke)}const xe="http://localhost:3000".replace(/\/+$/,"");class G{constructor(e={}){this.configuration=e}set config(e){this.configuration=e}get basePath(){return this.configuration.basePath!=null?this.configuration.basePath:xe}get fetchApi(){return this.configuration.fetchApi}get middleware(){return this.configuration.middleware||[]}get queryParamsStringify(){return this.configuration.queryParamsStringify||V}get username(){return this.configuration.username}get password(){return this.configuration.password}get apiKey(){const e=this.configuration.apiKey;if(e)return typeof e=="function"?e:()=>e}get accessToken(){const e=this.configuration.accessToken;if(e)return typeof e=="function"?e:async()=>e}get headers(){return this.configuration.headers}get credentials(){return this.configuration.credentials}}const $e=new G,D=class D{constructor(e=$e){b(this,"middleware");b(this,"fetchApi",async(e,n)=>{let i={url:e,init:n};for(const a of this.middleware)a.pre&&(i=await a.pre({fetch:this.fetchApi,...i})||i);let r;try{r=await(this.configuration.fetchApi||fetch)(i.url,i.init)}catch(a){for(const m of this.middleware)m.onError&&(r=await m.onError({fetch:this.fetchApi,url:i.url,init:i.init,error:a,response:r?r.clone():void 0})||r);if(r===void 0)throw a instanceof Error?new Ne(a,"The request failed and the interceptors did not return an alternative response"):a}for(const a of this.middleware)a.post&&(r=await a.post({fetch:this.fetchApi,url:i.url,init:i.init,response:r.clone()})||r);return r});this.configuration=e,this.middleware=e.middleware}withMiddleware(...e){const n=this.clone();return n.middleware=n.middleware.concat(...e),n}withPreMiddleware(...e){const n=e.map(i=>({pre:i}));return this.withMiddleware(...n)}withPostMiddleware(...e){const n=e.map(i=>({post:i}));return this.withMiddleware(...n)}isJsonMime(e){return e?D.jsonRegex.test(e):!1}async request(e,n){const{url:i,init:r}=await this.createFetchParams(e,n),a=await this.fetchApi(i,r);if(a&&a.status>=200&&a.status<300)return a;throw new Ue(a,"Response returned an error code")}async createFetchParams(e,n){let i=this.configuration.basePath+e.path;e.query!==void 0&&Object.keys(e.query).length!==0&&(i+="?"+this.configuration.queryParamsStringify(e.query));const r=Object.assign({},this.configuration.headers,e.headers);Object.keys(r).forEach(o=>r[o]===void 0?delete r[o]:{});const a=typeof n=="function"?n:async()=>n,m={method:e.method,headers:r,body:e.body,credentials:this.configuration.credentials},w={...m,...await a({init:m,context:e})};let h;Me(w.body)||w.body instanceof URLSearchParams||qe(w.body)?h=w.body:this.isJsonMime(r["Content-Type"])?h=JSON.stringify(w.body):h=w.body;const c={...w,body:h};return{url:i,init:c}}clone(){const e=this.constructor,n=new e(this.configuration);return n.middleware=this.middleware.slice(),n}};b(D,"jsonRegex",new RegExp("^(:?application/json|[^;/ 	]+/[^;/ 	]+[+]json)[ 	]*(:?;.*)?$","i"));let O=D;function qe(t){return typeof Blob<"u"&&t instanceof Blob}function Me(t){return typeof FormData<"u"&&t instanceof FormData}class Ue extends Error{constructor(n,i){super(i);b(this,"name","ResponseError");this.response=n}}class Ne extends Error{constructor(n,i){super(i);b(this,"name","FetchError");this.cause=n}}class Fe extends Error{constructor(n,i){super(i);b(this,"name","RequiredError");this.field=n}}function V(t,e=""){return Object.keys(t).map(n=>Q(n,t[n],e)).filter(n=>n.length>0).join("&")}function Q(t,e,n=""){const i=n+(n.length?`[${t}]`:t);if(e instanceof Array){const r=e.map(a=>encodeURIComponent(String(a))).join(`&${encodeURIComponent(i)}=`);return`${encodeURIComponent(i)}=${r}`}if(e instanceof Set){const r=Array.from(e);return Q(t,r,n)}return e instanceof Date?`${encodeURIComponent(i)}=${encodeURIComponent(e.toISOString())}`:e instanceof Object?V(e,i):`${encodeURIComponent(i)}=${encodeURIComponent(String(e))}`}class T{constructor(e,n=i=>i){this.raw=e,this.transformer=n}async value(){return this.transformer(await this.raw.json())}}function W(t){return We(t)}function We(t,e){return t==null?t:{createdAt:t.createdAt==null?void 0:new Date(t.createdAt),hardwareId:t.hardwareId,id:t.id,mediaUris:t.mediaUris,name:t.name,updatedAt:new Date(t.updatedAt)}}function Be(t){return Je(t)}function Je(t,e){return t==null?t:{date:new Date(t.date)}}function ze(t){return He(t)}function He(t,e){return t==null?t:{host:t.host,id:t.id,password:t.password,ssl:t.ssl}}function Ke(t){return Ge(t)}function Ge(t,e){return t==null?t:{build:t.build,version:t.version}}class Ve extends O{async healthCheckRaw(e){const n={},i={},r=await this.request({path:"/health",method:"GET",headers:i,query:n},e);return new T(r,a=>Be(a))}async healthCheck(e){return await(await this.healthCheckRaw(e)).value()}async remoteAccessRaw(e){const n={},i={},r=await this.request({path:"/remote-access",method:"GET",headers:i,query:n},e);return new T(r,a=>ze(a))}async remoteAccess(e){return await(await this.remoteAccessRaw(e)).value()}async versionRaw(e){const n={},i={},r=await this.request({path:"/version",method:"GET",headers:i,query:n},e);return new T(r,a=>Ke(a))}async version(e){return await(await this.versionRaw(e)).value()}}class Qe extends O{async cameraByHardwareIdRaw(e,n){if(e.hardwareId==null)throw new Fe("hardwareId",'Required parameter "hardwareId" was null or undefined when calling cameraByHardwareId().');const i={},r={},a=await this.request({path:"/cameras/{hardwareId}".replace("{hardwareId}",encodeURIComponent(String(e.hardwareId))),method:"GET",headers:r,query:i},n);return new T(a,m=>W(m))}async cameraByHardwareId(e,n){return await(await this.cameraByHardwareIdRaw({hardwareId:e},n)).value()}async camerasRaw(e){const n={},i={},r=await this.request({path:"/cameras",method:"GET",headers:i,query:n},e);return new T(r,a=>a.map(W))}async cameras(e){return await(await this.camerasRaw(e)).value()}}const Xe={middleware:[{pre:async t=>({...t,init:{...t.init,mode:"cors"}})}],apiKey(t){switch(t){default:return""}},credentials:"same-origin",get fetchApi(){return F()==="remote"?Oe():fetch},get basePath(){if(F()==="local"){const e=se();if(e)return B(e.host,e.ssl)}return""}},X=new G(Xe);new Ve(X);const nt=new Qe(X);export{Ve as A,G as C,Ue as R,De as a,_e as b,nt as c,Xe as d,ke as e};
