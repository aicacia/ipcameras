var Sr=Object.defineProperty;var Cr=(t,e,n)=>e in t?Sr(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var Y=(t,e,n)=>Cr(t,typeof e!="symbol"?e+"":e,n);import{M as Rr,i as _r,a as Or,p as Ir,g as sn,c as on}from"./notifications.CB67zdXi.js";import{g as an,a as br}from"./httpAccess.TKbybTVh.js";import{l as Ar}from"./localstorageWritable.DviM0pTl.js";import{e as We,n as cn,d as Te}from"./scheduler.Bu9aYH8f.js";import{S as un,i as ln,A as Qe,B as Ze,b as se,h as B,j as U,k as He,l as Ce,e as Tt,s as Dr,a as wt,f as Pr,D as Ot,t as dn,g as fn,n as hn}from"./index.Bw_3EgnJ.js";import{L as at}from"./i18n-svelte.DgV7mMaz.js";import{e as Pe}from"./each.BGHwlt_R.js";function Lr(t){return t[3]|t[2]<<8|t[1]<<16|t[0]<<24}const Ur="HTTP-WEBRTC",Fr="1.0",$r=`${Ur}/${Fr}`,kr=6e4,It=13,bt=10;function Le(t,e,n){const r=t.encode(n);return pn(e,r)}function pn(t,e){const n=new Uint8Array(t.length+e.length);return n.set(t),n.set(e,t.length),n}function At(){return Math.random()*Rr|0}function Wr(t){const e=new Response(t.stream.readable,{status:t.status,statusText:t.statusText,headers:t.headers,duplex:"half"});return Object.defineProperty(e,"url",{value:`webrtc-http:${t.url.pathname}${t.url.search}`}),e}function Mr(t){const e=new Map,n=new TextEncoder,r=new TextDecoder;function s(f,d,h,m){const E=new TransformStream,T={connectionId:f,url:new URL(d.url),handled:!1,readStatus:!1,readHeaders:!1,headers:new Headers,status:200,statusText:"",stream:E,writer:E.writable.getWriter(),handle(p,I){if(T.handled){m(new TypeError("Response already handled"));return}T.handled=!0,p?m(p):I?h(I):m(new TypeError("No response"))}};return T.timeoutId=setTimeout(()=>T.handle(new TypeError("Request timed out")),kr),T}function i(f,d,h){let m=At();for(;e.has(m);)m=At();const E=s(m,f,d,h);return e.set(m,E),E}async function o(f,d){const h=new URL(d.url),m=_r(new Uint8Array(4),f);if(t.send(Le(n,m,`${d.method} ${h.pathname+h.search} ${$r}`)),d.headers.forEach((E,T)=>{t.send(Le(n,m,`${T}: ${E}`))}),t.send(Le(n,m,`\r
`)),d.body){const E=d.body.getReader();for(;;){const{done:T,value:p}=await E.read();if(p&&t.send(pn(m,p)),T)break}}t.send(Le(n,m,`\r
`))}async function a(f,d){const h=e.get(f);if(h)if(h.readStatus)if(h.readHeaders)await h.writer.ready,d[0]===It&&d[1]===bt?(e.delete(f),clearTimeout(h.timeoutId),h.timeoutId=void 0,await h.writer.close()):await h.writer.write(d);else if(d[0]===It&&d[1]===bt)h.readHeaders=!0,h.handle(void 0,Wr(h));else{const[m,E]=r.decode(d).split(/\:\s+/);h.headers.append(m,E)}else{h.readStatus=!0;const[m,E,T]=r.decode(d).split(/\s+/,3);h.status=Number.parseInt(E),h.statusText=T}}async function c(f){const d=new Uint8Array(f.data),h=Lr(d);await a(h,d.slice(4))}t.addEventListener("message",c);function l(f,d){return new Promise((h,m)=>{const E=new Request(f,d),T=i(E,h,m);o(T.connectionId,E)})}return l.destroy=()=>t.removeEventListener("message",c),l}var b=[];for(var et=0;et<256;++et)b.push((et+256).toString(16).slice(1));function xr(t,e=0){return(b[t[e+0]]+b[t[e+1]]+b[t[e+2]]+b[t[e+3]]+"-"+b[t[e+4]]+b[t[e+5]]+"-"+b[t[e+6]]+b[t[e+7]]+"-"+b[t[e+8]]+b[t[e+9]]+"-"+b[t[e+10]]+b[t[e+11]]+b[t[e+12]]+b[t[e+13]]+b[t[e+14]]+b[t[e+15]]).toLowerCase()}var Ue,Br=new Uint8Array(16);function Gr(){if(!Ue&&(Ue=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Ue))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Ue(Br)}var jr=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const Dt={randomUUID:jr};function Pt(t,e,n){if(Dt.randomUUID&&!e&&!t)return Dt.randomUUID();t=t||{};var r=t.random||(t.rng||Gr)();return r[6]=r[6]&15|64,r[8]=r[8]&63|128,xr(r)}var Vi=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function qr(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Hi(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var s=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,s.get?s:{enumerable:!0,get:function(){return t[r]}})}),n}var gn={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function s(c,l,f){this.fn=c,this.context=l,this.once=f||!1}function i(c,l,f,d,h){if(typeof f!="function")throw new TypeError("The listener must be a function");var m=new s(f,d||c,h),E=n?n+l:l;return c._events[E]?c._events[E].fn?c._events[E]=[c._events[E],m]:c._events[E].push(m):(c._events[E]=m,c._eventsCount++),c}function o(c,l){--c._eventsCount===0?c._events=new r:delete c._events[l]}function a(){this._events=new r,this._eventsCount=0}a.prototype.eventNames=function(){var l=[],f,d;if(this._eventsCount===0)return l;for(d in f=this._events)e.call(f,d)&&l.push(n?d.slice(1):d);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(f)):l},a.prototype.listeners=function(l){var f=n?n+l:l,d=this._events[f];if(!d)return[];if(d.fn)return[d.fn];for(var h=0,m=d.length,E=new Array(m);h<m;h++)E[h]=d[h].fn;return E},a.prototype.listenerCount=function(l){var f=n?n+l:l,d=this._events[f];return d?d.fn?1:d.length:0},a.prototype.emit=function(l,f,d,h,m,E){var T=n?n+l:l;if(!this._events[T])return!1;var p=this._events[T],I=arguments.length,_,w;if(p.fn){switch(p.once&&this.removeListener(l,p.fn,void 0,!0),I){case 1:return p.fn.call(p.context),!0;case 2:return p.fn.call(p.context,f),!0;case 3:return p.fn.call(p.context,f,d),!0;case 4:return p.fn.call(p.context,f,d,h),!0;case 5:return p.fn.call(p.context,f,d,h,m),!0;case 6:return p.fn.call(p.context,f,d,h,m,E),!0}for(w=1,_=new Array(I-1);w<I;w++)_[w-1]=arguments[w];p.fn.apply(p.context,_)}else{var Ee=p.length,P;for(w=0;w<Ee;w++)switch(p[w].once&&this.removeListener(l,p[w].fn,void 0,!0),I){case 1:p[w].fn.call(p[w].context);break;case 2:p[w].fn.call(p[w].context,f);break;case 3:p[w].fn.call(p[w].context,f,d);break;case 4:p[w].fn.call(p[w].context,f,d,h);break;default:if(!_)for(P=1,_=new Array(I-1);P<I;P++)_[P-1]=arguments[P];p[w].fn.apply(p[w].context,_)}}return!0},a.prototype.on=function(l,f,d){return i(this,l,f,d,!1)},a.prototype.once=function(l,f,d){return i(this,l,f,d,!0)},a.prototype.removeListener=function(l,f,d,h){var m=n?n+l:l;if(!this._events[m])return this;if(!f)return o(this,m),this;var E=this._events[m];if(E.fn)E.fn===f&&(!h||E.once)&&(!d||E.context===d)&&o(this,m);else{for(var T=0,p=[],I=E.length;T<I;T++)(E[T].fn!==f||h&&!E[T].once||d&&E[T].context!==d)&&p.push(E[T]);p.length?this._events[m]=p.length===1?p[0]:p:o(this,m)}return this},a.prototype.removeAllListeners=function(l){var f;return l?(f=n?n+l:l,this._events[f]&&o(this,f)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,t.exports=a})(gn);var Kr=gn.exports;const En=qr(Kr),Vr=16384,Hr={RTCPeerConnection:typeof RTCPeerConnection>"u"?null:RTCPeerConnection,RTCSessionDescription:typeof RTCSessionDescription>"u"?null:RTCSessionDescription,RTCIceCandidate:typeof RTCIceCandidate>"u"?null:RTCIceCandidate};class Xr extends En{constructor(e){super(),this.initiator=!1,this.maxChannelMessageSize=Vr,this.sdpTransform=zr,this.config={iceServers:[]},this.pendingCandidates=[],this.webrtc=Hr,this.id=e.id||Pt(),this.channelName=e.channelName||Pt(),e.channelConfig&&(this.channelConfig=e.channelConfig),e.sdpTransform&&(this.sdpTransform=e.sdpTransform),e.config&&(this.config=e.config),e.offerConfig&&(this.offerConfig=e.offerConfig),e.answerConfig&&(this.answerConfig=e.answerConfig),e.maxChannelMessageSize&&e.maxChannelMessageSize>0&&(this.maxChannelMessageSize=e.maxChannelMessageSize),e.webrtc&&(this.webrtc=e.webrtc)}getId(){return this.id}getConnection(){return this.connection}getChannel(){return this.channel}isReady(){return this.channel&&this.channel.readyState==="open"}isClosed(){return!this.connection||this.connection.connectionState!=="connected"}ready(){return this.isReady()?Promise.resolve():this.waitOnce("connect")}isInitiator(){return this.initiator}init(){return this.initiator=!0,this.createPeer()}close(){return this.internalClose(!0)}send(e){if(!this.channel)throw new Error("Channel not initialized");return this.channel.send(e),this}write(e){if(!this.channel)throw new Error("Channel not initialized");return mn(this.channel,e,this.maxChannelMessageSize)}writableStream(){if(!this.channel)throw new Error("Channel not initialized");return Jr(this.channel,this.maxChannelMessageSize)}readableStream(){if(!this.channel)throw new Error("Channel not initialized");return Yr(this.channel)}async signal(e){var n,r;switch(this.connection||await this.createPeer(),console.debug(`${this.id}: received signal message=${e.type}`),e.type){case"renegotiate":return this.negotiate();case"transceiverRequest":{if(!this.initiator)throw new Error("Invalid signal state");const s=e.transceiverRequest;if(!s)throw new Error("Invalid signal message");return await this.addTransceiverFromKind(s.kind,s.init),this}case"candidate":{if(!this.connection)throw new Error("Connection not initialized");const s=e.candidate;if(!s)throw new Error("Invalid signal message");const i=new this.webrtc.RTCIceCandidate(s);return this.connection.remoteDescription==null?this.pendingCandidates.push(i):await this.connection.addIceCandidate(i),this}case"answer":case"offer":case"pranswer":case"rollback":{if(!this.connection)throw new Error("Connection not initialized");const s=e.sdp;if(!s)throw new Error("Invalid signal message");const i=new this.webrtc.RTCSessionDescription({type:e.type,sdp:s});await this.connection.setRemoteDescription(i);for(const o of this.pendingCandidates)await this.connection.addIceCandidate(o);return this.pendingCandidates.length=0,((r=(n=this.connection)===null||n===void 0?void 0:n.remoteDescription)===null||r===void 0?void 0:r.type)==="offer"&&await this.createAnswer(),this.emit("negotiated"),console.debug(`${this.id}: set remote sdp`),this}default:throw console.debug(`${this.id}: invalid signal type: ${e}`),new Error("Invalid signal message type")}}waitOnce(e){return new Promise(n=>{this.once(e,(...r)=>{switch(r.length){case 0:n(void 0);break;case 1:n(r[0]);break;default:n(r);break}})})}addTransceiverFromKind(e,n){if(!this.connection)throw new Error("Connection not initialized");if(this.initiator){const r=this.connection.addTransceiver(e,n);return this.emit("transceiver",r),r}return this.internalSignal({type:"transceiverRequest",transceiverRequest:{kind:e,init:n}}),null}addTrack(e){if(!this.connection)throw new Error("Connection not initialized");return this.connection.addTrack(e)}removeTrack(e){if(!this.connection)throw new Error("Connection not initialized");return this.connection.removeTrack(e),this}internalSignal(e){return this.emit("signal",e),this}async negotiate(){return this.initiator?await this.createOffer():this.internalSignal({type:"renegotiate",renegotiate:!0}),this}async createOffer(){if(!this.connection)throw new Error("Connection not initialized");const e=await this.connection.createOffer(this.offerConfig);return e.sdp=this.sdpTransform(e.sdp),await this.connection.setLocalDescription(e),this.internalSignal({type:e.type,sdp:e.sdp}),this}async createAnswer(){if(!this.connection)throw new Error("Connection not initialized");const e=await this.connection.createAnswer(this.answerConfig);return e.sdp=this.sdpTransform(e.sdp),await this.connection.setLocalDescription(e),this.internalSignal({type:e.type,sdp:e.sdp}),this}createPeer(){if(this.internalClose(!1),this.connection=new this.webrtc.RTCPeerConnection(this.config),this.connection.addEventListener("negotiationneeded",this.onNegotiationNeeded.bind(this)),this.connection.addEventListener("iceconnectionstatechange",this.onICEConnectionStateChange.bind(this)),this.connection.addEventListener("icegatheringstatechange",this.onICEGatheringStateChange.bind(this)),this.connection.addEventListener("connectionstatechange",this.onConnectionStateChange.bind(this)),this.connection.addEventListener("icecandidate",this.onICECandidate.bind(this)),this.connection.addEventListener("signalingstatechange",this.onSignalingStateChange.bind(this)),this.connection.addEventListener("track",this.onTrackRemote.bind(this)),this.initiator){const e=this.connection.createDataChannel(this.channelName,this.channelConfig);e.addEventListener("open",this.onDataChannelOpen.bind(this)),e.addEventListener("message",this.onDataChannelMessage.bind(this)),e.addEventListener("error",this.onDataChannelError.bind(this)),this.channel=e}else this.connection.addEventListener("datachannel",this.onDataChannel.bind(this));return this}internalClose(e=!0){return this.channel&&(this.channel.close(),this.channel=void 0),this.connection&&(this.connection.close(),this.connection=void 0),e&&this.emit("close"),this}onConnectionStateChange(){if(this.connection)switch(console.debug(`${this.id}: connection state ${this.connection.connectionState}`),this.connection.connectionState){case"failed":case"disconnected":case"closed":this.internalClose(!0);break}}onNegotiationNeeded(){if(this.connection)return this.negotiate()}onICEConnectionStateChange(){this.connection&&console.debug(`${this.id}: ice connection state ${this.connection.iceConnectionState}`)}onICEGatheringStateChange(){this.connection&&console.debug(`${this.id}: ice gathering state ${this.connection.iceGatheringState}`)}onSignalingStateChange(){this.connection&&console.debug(`${this.id}: signaling state ${this.connection.signalingState}`)}onICECandidate(e){e.candidate&&this.internalSignal({type:"candidate",candidate:e.candidate})}onTrackRemote(e){this.emit("track",e)}onDataChannel(e){const n=e.channel;this.channel=n,this.channel.onopen=this.onDataChannelOpen.bind(this),this.channel.onmessage=this.onDataChannelMessage.bind(this),this.channel.onerror=this.onDataChannelError.bind(this)}onDataChannelOpen(){console.debug(`${this.id}: data channel open`),this.emit("connect")}onDataChannelMessage(e){this.emit("data",e.data)}onDataChannelError(e){this.emit("error",new Error("DataChannel error",{cause:e}))}}function zr(t){return t}function mn(t,e,n){if(typeof e=="string")if(e.length<n)t.send(e);else{let r=0;for(;r<e.length;){const s=Math.min(n,e.length-r);t.send(e.substring(r,r+s)),r+=s}}else if(e instanceof Blob)if(e.size<n)t.send(e);else{let r=0;for(;r<e.size;){const s=Math.min(n,e.size-r);t.send(e.slice(r,r+s)),r+=s}}else{let r;if(e instanceof ArrayBuffer?r=e:r=e.buffer,r.byteLength<n)t.send(r);else{let s=0;for(;s<r.byteLength;){const i=Math.min(n,r.byteLength-s);t.send(r.slice(s,s+i)),s+=i}}}}function Jr(t,e){return new WritableStream({write(n){mn(t,n,e)}})}function Yr(t){let e=!1,n=!1;const r=[],s=[];function i(){return new Promise((c,l)=>s.push([c,l]))}function o(c){if(s.length){const[l,f]=s.shift();l(c.data)}else r.push(c.data)}t.addEventListener("message",o);const a=()=>{if(!e){t.removeEventListener("message",o),t.removeEventListener("close",a),e=!0;for(const[c,l]of s)l(new Error("Stream closed"));s.length=0,r.length=0}};return t.addEventListener("close",a),new ReadableStream({async pull(c){if(e){n||(n=!0,c.close());return}r.length?c.enqueue(r.shift()):c.enqueue(await i())},cancel:a})}class Qr extends En{constructor(e){super(),this.connected=!1,this.connecting=!1,this.reconnecting=!1,this.closed=!1,this.connectTime=Date.now(),this.minTimeBetweenReconnectsMS=0,this.url=e.url,e.WebSocket?this.WebSocket=e.WebSocket:this.WebSocket=WebSocket,e.minTimeBetweenReconnectsMS&&(this.minTimeBetweenReconnectsMS=e.minTimeBetweenReconnectsMS),e.autoconnect&&this.connect()}send(e){var n;if(!this.connected)throw new Error("WebSocket not ready");return(n=this.websocket)===null||n===void 0||n.send(e),this}ready(){return this.connected?Promise.resolve():this.waitOnce("open")}waitOnce(e){return new Promise(n=>{this.once(e,(...r)=>{switch(r.length){case 0:n(void 0);break;case 1:n(r[0]);break;default:n(r);break}})})}close(e,n){this.connected=!1,this.connecting=!1,this.closed=!0,this.websocket?this.websocket.close(e,n):this.emit("close")}async connect(){if(this.connected)return this;if(this.connecting)return this;this.connecting=!0;try{this.connectTime=Date.now();const e=new this.WebSocket(await this.url()),n=()=>{e.removeEventListener("open",n),this.connected=!0,this.emit("open")};e.addEventListener("open",n),e.addEventListener("close",()=>{this.websocket=void 0,this.connected=!1,this.closed?this.emit("close"):(this.emit("disconnect"),this.reconnect())}),e.addEventListener("message",r=>{this.emit("message",r.data)}),e.addEventListener("error",()=>{this.emit("error")}),this.websocket=e}catch(e){this.emit("error",e),this.reconnect()}finally{this.connecting=!1}return this}reconnect(){if(this.reconnecting)return this;this.reconnecting=!0;try{const e=Date.now()-this.connectTime;e<this.minTimeBetweenReconnectsMS?setTimeout(()=>{this.connect()},this.minTimeBetweenReconnectsMS-e):this.connect()}finally{this.reconnecting=!1}return this}}const ct=new Map,me=new Qr({url:ts});me.on("message",t=>{const e=JSON.parse(t),n=ct.get(e.peerId);n&&n.signal(e.message)});let Fe;function Zr(){if(Fe)return Fe;{let t;return Fe=(e,n)=>{if(!t){const r=es("webrtchttp");t=r.ready().then(()=>(console.debug(`${r.getId()}: ready`),Mr(r.getChannel()))),r.on("close",()=>{t=void 0})}return t.then(r=>r(e,n))},Fe}}function es(t){me.connect();const e=new Xr({config:{iceServers:[{urls:["stun:stun.l.google.com:19302"]}]},channelConfig:{ordered:!0}});return e.on("error",n=>console.error(n)),e.on("signal",n=>{me.send(JSON.stringify({type:"signal",peerId:e.getId(),message:n}))}),me.ready().then(()=>{me.send(JSON.stringify({type:"init",peerId:e.getId(),peerType:t}))}),e.on("close",()=>{ct.delete(e.getId())}),ct.set(e.getId(),e),e}async function ts(){const t=an();if(!t)throw new Error("No remote access configured");const e=await ns(t);return`${Or(t.host,t.ssl)}/client/websocket?token=${e}`}let tt,nt;async function ns(t){return(!nt||nt<=Date.now())&&(tt=await rs(t),nt=Ir(tt).exp*1e3),tt}async function rs(t){const e={id:t.id,password:t.password},n={"Content-Type":"application/json"},r=await fetch(`${sn(t.host,t.ssl)}/client`,{method:"POST",headers:n,credentials:"same-origin",mode:"cors",body:JSON.stringify(e)});if(r.status>=400)throw new Error("failed to authenticate");return await r.text()}const ss=Ar("access","http");function Lt(){return We(ss)}const is="http://localhost:3000".replace(/\/+$/,"");class Tn{constructor(e={}){this.configuration=e}set config(e){this.configuration=e}get basePath(){return this.configuration.basePath!=null?this.configuration.basePath:is}get fetchApi(){return this.configuration.fetchApi}get middleware(){return this.configuration.middleware||[]}get queryParamsStringify(){return this.configuration.queryParamsStringify||Nn}get username(){return this.configuration.username}get password(){return this.configuration.password}get apiKey(){const e=this.configuration.apiKey;if(e)return typeof e=="function"?e:()=>e}get accessToken(){const e=this.configuration.accessToken;if(e)return typeof e=="function"?e:async()=>e}get headers(){return this.configuration.headers}get credentials(){return this.configuration.credentials}}const os=new Tn,Ve=class Ve{constructor(e=os){Y(this,"middleware");Y(this,"fetchApi",async(e,n)=>{let r={url:e,init:n};for(const i of this.middleware)i.pre&&(r=await i.pre({fetch:this.fetchApi,...r})||r);let s;try{s=await(this.configuration.fetchApi||fetch)(r.url,r.init)}catch(i){for(const o of this.middleware)o.onError&&(s=await o.onError({fetch:this.fetchApi,url:r.url,init:r.init,error:i,response:s?s.clone():void 0})||s);if(s===void 0)throw i instanceof Error?new us(i,"The request failed and the interceptors did not return an alternative response"):i}for(const i of this.middleware)i.post&&(s=await i.post({fetch:this.fetchApi,url:r.url,init:r.init,response:s.clone()})||s);return s});this.configuration=e,this.middleware=e.middleware}withMiddleware(...e){const n=this.clone();return n.middleware=n.middleware.concat(...e),n}withPreMiddleware(...e){const n=e.map(r=>({pre:r}));return this.withMiddleware(...n)}withPostMiddleware(...e){const n=e.map(r=>({post:r}));return this.withMiddleware(...n)}isJsonMime(e){return e?Ve.jsonRegex.test(e):!1}async request(e,n){const{url:r,init:s}=await this.createFetchParams(e,n),i=await this.fetchApi(r,s);if(i&&i.status>=200&&i.status<300)return i;throw new wn(i,"Response returned an error code")}async createFetchParams(e,n){let r=this.configuration.basePath+e.path;e.query!==void 0&&Object.keys(e.query).length!==0&&(r+="?"+this.configuration.queryParamsStringify(e.query));const s=Object.assign({},this.configuration.headers,e.headers);Object.keys(s).forEach(f=>s[f]===void 0?delete s[f]:{});const i=typeof n=="function"?n:async()=>n,o={method:e.method,headers:s,body:e.body,credentials:this.configuration.credentials},a={...o,...await i({init:o,context:e})};let c;cs(a.body)||a.body instanceof URLSearchParams||as(a.body)?c=a.body:this.isJsonMime(s["Content-Type"])?c=JSON.stringify(a.body):c=a.body;const l={...a,body:c};return{url:r,init:l}}clone(){const e=this.constructor,n=new e(this.configuration);return n.middleware=this.middleware.slice(),n}};Y(Ve,"jsonRegex",new RegExp("^(:?application/json|[^;/ 	]+/[^;/ 	]+[+]json)[ 	]*(:?;.*)?$","i"));let Me=Ve;function as(t){return typeof Blob<"u"&&t instanceof Blob}function cs(t){return typeof FormData<"u"&&t instanceof FormData}class wn extends Error{constructor(n,r){super(r);Y(this,"name","ResponseError");this.response=n}}class us extends Error{constructor(n,r){super(r);Y(this,"name","FetchError");this.cause=n}}class rt extends Error{constructor(n,r){super(r);Y(this,"name","RequiredError");this.field=n}}function Nn(t,e=""){return Object.keys(t).map(n=>yn(n,t[n],e)).filter(n=>n.length>0).join("&")}function yn(t,e,n=""){const r=n+(n.length?`[${t}]`:t);if(e instanceof Array){const s=e.map(i=>encodeURIComponent(String(i))).join(`&${encodeURIComponent(r)}=`);return`${encodeURIComponent(r)}=${s}`}if(e instanceof Set){const s=Array.from(e);return yn(t,s,n)}return e instanceof Date?`${encodeURIComponent(r)}=${encodeURIComponent(e.toISOString())}`:e instanceof Object?Nn(e,r):`${encodeURIComponent(r)}=${encodeURIComponent(String(e))}`}class ie{constructor(e,n=r=>r){this.raw=e,this.transformer=n}async value(){return this.transformer(await this.raw.json())}}function st(t){return ls(t)}function ls(t,e){return t==null?t:{createdAt:t.createdAt==null?void 0:new Date(t.createdAt),discovered:t.discovered,hardwareId:t.hardwareId,mediaUris:t.mediaUris,name:t.name,record:t.record,recordWindow:t.recordWindow==null?void 0:t.recordWindow,saved:t.saved,updatedAt:new Date(t.updatedAt)}}function ds(t){return fs(t)}function fs(t,e){return t==null?t:{date:new Date(t.date)}}function hs(t){return ps(t)}function ps(t,e){return t==null?t:{host:t.host,id:t.id,password:t.password,ssl:t.ssl}}function gs(t){return Es(t)}function Es(t,e){return t==null?t:{build:t.build,version:t.version}}class ms extends Me{async healthCheckRaw(e){const n={},r={},s=await this.request({path:"/health",method:"GET",headers:r,query:n},e);return new ie(s,i=>ds(i))}async healthCheck(e){return await(await this.healthCheckRaw(e)).value()}async p2pAccessRaw(e){const n={},r={},s=await this.request({path:"/p2p-access",method:"GET",headers:r,query:n},e);return new ie(s,i=>hs(i))}async p2pAccess(e){return await(await this.p2pAccessRaw(e)).value()}async versionRaw(e){const n={},r={},s=await this.request({path:"/version",method:"GET",headers:r,query:n},e);return new ie(s,i=>gs(i))}async version(e){return await(await this.versionRaw(e)).value()}}class Ts extends Me{async cameraByHardwareIdRaw(e,n){if(e.hardwareId==null)throw new rt("hardwareId",'Required parameter "hardwareId" was null or undefined when calling cameraByHardwareId().');const r={},s={},i=await this.request({path:"/cameras/{hardwareId}".replace("{hardwareId}",encodeURIComponent(String(e.hardwareId))),method:"GET",headers:s,query:r},n);return new ie(i,o=>st(o))}async cameraByHardwareId(e,n){return await(await this.cameraByHardwareIdRaw({hardwareId:e},n)).value()}async camerasRaw(e){const n={},r={},s=await this.request({path:"/cameras",method:"GET",headers:r,query:n},e);return new ie(s,i=>i.map(st))}async cameras(e){return await(await this.camerasRaw(e)).value()}async updateCameraByHardwareIdRaw(e,n){if(e.hardwareId==null)throw new rt("hardwareId",'Required parameter "hardwareId" was null or undefined when calling updateCameraByHardwareId().');if(e.updates==null)throw new rt("updates",'Required parameter "updates" was null or undefined when calling updateCameraByHardwareId().');const r={},s={};s["Content-Type"]="application/json";const i=await this.request({path:"/cameras/{hardwareId}".replace("{hardwareId}",encodeURIComponent(String(e.hardwareId))),method:"PATCH",headers:s,query:r,body:e.updates},n);return new ie(i,o=>st(o))}async updateCameraByHardwareId(e,n,r){return await(await this.updateCameraByHardwareIdRaw({hardwareId:e,updates:n},r)).value()}}const ws={middleware:[{pre:async t=>({...t,init:{...t.init,mode:"cors"}})}],apiKey(t){switch(t){default:return""}},credentials:"same-origin",get fetchApi(){return Lt()==="p2p"&&an()?Zr():fetch},get basePath(){if(Lt()==="http"){const e=br();if(e)return sn(e.host,e.ssl)}return""}},vn=new Tn(ws);new ms(vn);const Xi=new Ts(vn);function y(t){return(...e)=>!t(...e)}function G(t){const e=String(t),n=Number(t);return!!(!isNaN(parseFloat(e))&&!isNaN(Number(t))&&isFinite(n))}const Ns=y(G);function pe(t,e){return G(t)&&G(e)&&Number(t)===Number(e)}const ys=y(pe);function Re(t,e){return pe(t.length,e)}const vs=y(Re);function ae(t,e){return G(t)&&G(e)&&Number(t)>Number(e)}function Sn(t,e){return ae(t.length,e)}function Cn(t=1){const e=[],n=(s,i)=>{const o=n.get(s);if(o)return o[1];const a=i();return e.unshift([s.concat(),a]),Sn(e,t)&&(e.length=t),a};return n.invalidate=s=>{const i=r(s);i>-1&&e.splice(i,1)},n.get=s=>e[r(s)]||null,n;function r(s){return e.findIndex(([i])=>Re(s,i.length)&&s.every((o,a)=>o===i[a]))}}function Xe(t){return t===null}const Ss=y(Xe);function ze(t){return t===void 0}const Cs=y(ze);function C(t){return Xe(t)||ze(t)}const Je=y(C);function Rn(t){return[].concat(t)}function Ut(t){return t.forEach(e=>e())}function we(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Z(t){return typeof t=="function"}function xe(t){return!!t&&Z(t.then)}function N(t,...e){return Z(t)?t(...e):t}var A=Object.assign;function Nt(t,e){var n;return(n=N(t))!==null&&n!==void 0?n:N(e)}function O(t,e){if(!t)throw e instanceof String?e.valueOf():new Error(e&&N(e))}function D(t){return String(t)===t}function Rs(t,e){return!!t!=!!e}function Ne(t){return!!t===t}function yt(t){setTimeout(()=>{throw new Error(t)},0)}var _s=Object.freeze({__proto__:null,createBus:function(){const t={};return{emit(n,r){e(n).concat(e("*")).forEach(s=>{s(r)})},on:(n,r)=>(t[n]=e(n).concat(r),{off(){t[n]=e(n).filter(s=>s!==r)}})};function e(n){return t[n]||[]}}});const Os=Is();function Is(t){return e=0,()=>`${e++}`;var e}function bs(t,e){let n=!1,r=null;for(let i=0;i<t.length;i++)if(e(t[i],s,i),n)return r;function s(i,o){i&&(n=!0,r=o)}}function _n(t){return typeof t=="object"&&!C(t)}function De(t){return!!Array.isArray(t)}const As=y(De);function ce(t){return!t||(we(t,"length")?Re(t,0):!!_n(t)&&Re(Object.keys(t),0))}const On=y(ce);function q(t){return ae(t,0)}const Ft=/{(.*?)}/g;function ue(t,...e){const n=e[0];if(_n(n))return t.replace(Ft,(s,i)=>{var o;return`${(o=n[i])!==null&&o!==void 0?o:s}`});const r=[...e];return t.replace(Ft,s=>`${ce(r)?s:r.shift()}`)}function In(t){let e=t.initial;return{getState:function(){return e},initial:function(){return t.initial},staticTransition:n,transition:function(r,s){return e=n(e,r,s)}};function n(r,s,i){var o,a,c;let l=(a=(o=t.states[r])===null||o===void 0?void 0:o[s])!==null&&a!==void 0?a:(c=t.states["*"])===null||c===void 0?void 0:c[s];if(Array.isArray(l)){const[,f]=l;if(!f(i))return r;l=l[0]}return l&&l!==r?l:r}}var Be=Object.freeze({__proto__:null,createTinyState:function(t){let e;return r(),()=>[e,n,r];function n(s){e=N(s,e)}function r(){n(N(t))}}});function $t(t){return new String(N(t))}function Ds(){}var ye=Object.freeze({__proto__:null,all:function(...t){return e=>!ce(t)&&t.every(n=>N(n,e))},any:function(...t){return e=>!ce(t)&&t.some(n=>N(n,e))}});const it=Symbol();function Ps(t){let e=it;return{run:function(s,i){const o=r()?n():it;e=s;const a=i();return e=o,a},use:n,useX:function(s){return O(r(),Nt(s,"Not inside of a running context.")),e}};function n(){return r()?e:t}function r(){return e!==it}}function vt(t){const e=Ps();return{bind:function(r,s){return function(...i){return n(r,function(){return s(...i)})}},run:n,use:e.use,useX:e.useX};function n(r,s){var i;const o=e.use(),a=A({},o||{},(i=N(t,r,o))!==null&&i!==void 0?i:r);return e.run(Object.freeze(a),s)}}const ut=vt((t,e)=>{const n={value:t.value,meta:t.meta||{}};return e?t.set?A(n,{parent:()=>function(r){return{value:r.value,meta:r.meta,parent:r.parent}}(e)}):e:A(n,{parent:Ls})});function Ls(){return null}function bn(t,e){return D(t)&&D(e)&&t.endsWith(e)}const Us=y(bn);function An(t,e){return t===e}const Fs=y(An);function Ge(t,e){return pe(t,e)||ae(t,e)}function Dn(t,e){return(De(e)||!(!D(e)||!D(t)))&&e.indexOf(t)!==-1}const $s=y(Dn);function _e(t,e){return G(t)&&G(e)&&Number(t)<Number(e)}function je(t,e){return pe(t,e)||_e(t,e)}function Pn(t,e,n){return Ge(t,e)&&je(t,n)}const ks=y(Pn);function Ln(t){return C(t)||D(t)&&!t.trim()}const Ws=y(Ln),Ms=y(Ne),xs=t=>!!G(t)&&t%2==0;function Un(t,e){return t in e}const Bs=y(Un);function Fn(t){return Number.isNaN(t)}const Gs=y(Fn);function js(t){return _e(t,0)}function $n(t){return typeof t=="number"}const qs=y($n),Ks=t=>!!G(t)&&t%2!=0,Vs=y(D);function kn(t){return!!t}const Hs=y(kn);function Wn(t,e){if(C(e))return!1;for(const n in e)if(e[n]===t)return!0;return!1}const Xs=y(Wn);function zs(t,e){return Ge(t.length,e)}function Mn(t,e){return e instanceof RegExp?e.test(t):!!D(e)&&new RegExp(e).test(t)}const Js=y(Mn);function Ys(t,e){try{return e(t)}catch{return!1}}function Qs(t,e){return _e(t.length,e)}function Zs(t,e){return je(t.length,e)}function xn(t,e){return D(t)&&D(e)&&t.startsWith(e)}const ei=y(xn),Bn={condition:Ys,doesNotEndWith:Us,doesNotStartWith:ei,endsWith:bn,equals:An,greaterThan:ae,greaterThanOrEquals:Ge,gt:ae,gte:Ge,inside:Dn,isArray:De,isBetween:Pn,isBlank:Ln,isBoolean:Ne,isEmpty:ce,isEven:xs,isFalsy:Hs,isKeyOf:Un,isNaN:Fn,isNegative:js,isNotArray:As,isNotBetween:ks,isNotBlank:Ws,isNotBoolean:Ms,isNotEmpty:On,isNotKeyOf:Bs,isNotNaN:Gs,isNotNull:Ss,isNotNullish:Je,isNotNumber:qs,isNotNumeric:Ns,isNotString:Vs,isNotUndefined:Cs,isNotValueOf:Xs,isNull:Xe,isNullish:C,isNumber:$n,isNumeric:G,isOdd:Ks,isPositive:q,isString:D,isTruthy:kn,isUndefined:ze,isValueOf:Wn,lengthEquals:Re,lengthNotEquals:vs,lessThan:_e,lessThanOrEquals:je,longerThan:Sn,longerThanOrEquals:zs,lt:_e,lte:je,matches:Mn,notEquals:Fs,notInside:$s,notMatches:Js,numberEquals:pe,numberNotEquals:ys,shorterThan:Qs,shorterThanOrEquals:Zs,startsWith:xn};function $e(t){return Bn[t]}function qe(t,e){const n={pass:t};return e&&(n.message=e),n}function ti(t){return Nt(t,qe(!0))}function Gn(t,e,n,...r){return function(s){O(Ne(s)||s&&Ne(s.pass),"Incorrect return value for rule: "+JSON.stringify(s))}(t),Ne(t)?qe(t):qe(t.pass,N(t.message,e,n,...r))}function ni(t){const e={message:function(s){return n=s,r},pass:!1};let n;const r=new Proxy(e,{get:(s,i)=>{const o=$e(i);return o?function(a,c,l){return function(...f){const d=ut.run({value:t},()=>Gn(c(t,...f),l,t,...f));function h(){return C(n)?C(d.message)?`enforce/${l} failed with ${JSON.stringify(t)}`:$t(d.message):$t(n)}return O(d.pass,h()),a.pass=d.pass,a}}(r,o,i):e[i]}});return r}const kt=function(){const t={context:()=>ut.useX(),extend:e=>{A(Bn,e)}};return new Proxy(A(ni,t),{get:(e,n)=>n in e?e[n]:$e(n)?function(r){const s=[];let i;return function o(a){return(...c)=>{const l=$e(a);s.push(d=>Gn(l(d,...c),a,d,...c));let f={run:d=>ti(bs(s,(h,m)=>{var E;const T=ut.run({value:d},()=>h(d));m(!T.pass,qe(!!T.pass,(E=N(i,d,T.message))!==null&&E!==void 0?E:T.message))})),test:d=>f.run(d).pass,message:d=>(d&&(i=d),f)};return f=new Proxy(f,{get:(d,h)=>$e(h)?o(h):d[h]}),f}}(r)}(n):void 0})}(),re={ISOLATE_ENTER:"ISOLATE_ENTER",ISOLATE_PENDING:"ISOLATE_PENDING",ISOLATE_DONE:"ISOLATE_DONE"};var oe;typeof SuppressedError=="function"&&SuppressedError,function(t){t.NO_ACTIVE_ISOLATE="Not within an active isolate",t.UNABLE_TO_PICK_NEXT_ISOLATE="Unable to pick next isolate. This is a bug, please report it to the Vest maintainers.",t.ENCOUNTERED_THE_SAME_KEY_TWICE='Encountered the same key "{key}" twice. This may lead to inconsistent or overriding of results.',t.INVALID_ISOLATE_CANNOT_PARSE="Invalid isolate was passed to IsolateSerializer. Cannot proceed."}(oe||(oe={}));class ${static at(e,n){var r,s;return C(e)?null:(s=(r=e.children)===null||r===void 0?void 0:r[n])!==null&&s!==void 0?s:null}static cursor(e){var n,r;return C(e)?0:(r=(n=e.children)===null||n===void 0?void 0:n.length)!==null&&r!==void 0?r:0}static canReorder(e){return!C(e)&&$.allowsReorder(e.parent)}static allowsReorder(e){return(e==null?void 0:e.allowReorder)===!0}static usesKey(e){return!C(e)&&Je(e.key)}static getChildByKey(e,n){var r,s;return C(e)?null:(s=(r=e.keys)===null||r===void 0?void 0:r[n])!==null&&s!==void 0?s:null}}class W{static setParent(e,n){return e.parent=n,e}static saveOutput(e,n){return e.output=n,e}static setKey(e,n){return e.key=n,e}static addChild(e,n){var r;O(e),e.children=(r=e.children)!==null&&r!==void 0?r:[],e.children.push(n),W.setParent(n,e)}static removeChild(e,n){var r,s;e.children=(s=(r=e.children)===null||r===void 0?void 0:r.filter(i=>i!==n))!==null&&s!==void 0?s:null}static addChildKey(e,n,r){var s;O(e),e.keys=(s=e.keys)!==null&&s!==void 0?s:{},e.keys[n]=r}static slice(e,n){C(e.children)||(e.children.length=n)}static setData(e,n){e.data=n}static abort(e,n){C(e.abortController)||e.abortController.abort(n)}}const ve=vt((t,e)=>{if(e)return null;O(t.historyRoot);const[n]=t.historyRoot(),r={};return A(r,{historyNode:n,runtimeNode:null,runtimeRoot:null,stateRef:t}),r}),jn=ve.run,S={Run:jn,addNodeToHistory:Hn,createRef:function(t,e){return Object.freeze({Bus:_s.createBus(),Reconciler:t,appData:N(e),historyRoot:Be.createTinyState(null)})},persist:qn,reset:function(){const[,,t]=ke();t()},useAvailableRoot:function(){const t=zn();if(t)return t;const[e]=ke();return e},useCurrentCursor:function(){const t=ee();return t?$.cursor(t):0},useHistoryRoot:ke,useLoadRootNode:function(t){Xn(t)},useXAppData:function(){return J().stateRef.appData}};function qn(t){const e=ve.useX();return(...n)=>{var r;const s=(r=ve.use())!==null&&r!==void 0?r:e;return ve.run(s.stateRef,()=>t(...n))}}function J(){return ve.useX()}function ke(){return J().stateRef.historyRoot()}function Kn(){return J().historyNode}function Vn(){const t=ee(),e=Kn();return t?$.at(e,$.cursor(t)):e}function Hn(t){const e=ee();e?function(n){const r=ee();O(r,oe.NO_ACTIVE_ISOLATE),W.addChild(r,n)}(t):Xn(t),W.setParent(t,e)}function Xn(t){const[,e]=ke();e(t)}function ee(){var t;return(t=J().runtimeNode)!==null&&t!==void 0?t:null}function zn(){return J().runtimeRoot}function Jn(){return J().stateRef.Bus}function lt(t,e){const n=Jn().emit;return C(t)||n(t,e),qn(n)}var F,X=Object.freeze({__proto__:null,useBus:Jn,useEmit:lt,usePrepareEmitter:function(t){const e=lt();return n=>e(t,n)}});(function(t){t.Type="$type",t.Keys="keys",t.Key="key",t.Parent="parent",t.Data="data",t.AllowReorder="allowReorder",t.Status="status",t.AbortController="abortController",t.Children="children"})(F||(F={}));F.AbortController,F.Parent,F.Keys;function Yn(t,e){return(t==null?void 0:t[F.Type])===e}function dt(t,e){return Yn(t,e[F.Type])}var Qn=Object.freeze({__proto__:null,isIsolateType:Yn,isSameIsolateIdentity:function(t,e){return Object.is(t,e)||dt(t,e)&&t.key===e.key},isSameIsolateType:dt});let ft=class Zn{static reconcile(e){const n=function(r,s){var i;if(C(s))return function(a){return $.usesKey(a)?Zn.handleIsolateNodeWithKey(a,!1):a}(r);if(!dt(r,s))return r;const o=J().stateRef.Reconciler;return(i=o(r,s))!==null&&i!==void 0?i:function(a,c){return a}(r)}(e,Vn());return O(n,oe.UNABLE_TO_PICK_NEXT_ISOLATE),n}static dropNextNodesOnReorder(e,n,r){const s=e(n,r);return s&&function(){const i=ee(),o=Kn();!o||!i||W.slice(o,$.cursor(i))}(),s}static handleIsolateNodeWithKey(e,n){O($.usesKey(e));const r=function(i){if(C(i))return null;const o=J().historyNode;return $.getChildByKey(o,i)}(e.key);let s=e;return C(r)||N(n,r)||(s=r),function(i,o){if(!i)return;const a=ee();O(a,oe.NO_ACTIVE_ISOLATE),C($.getChildByKey(a,i))?W.addChildKey(a,i,o):yt(ue(oe.ENCOUNTERED_THE_SAME_KEY_TWICE,{key:i}))}(e.key,s),s}},ge=class er{static create(e,n,r,s){const i=ee(),o=W.setParent(function(d,h,m=null){const E=h??{},{allowReorder:T,status:p}=E,I=function(_,w){var Ee={};for(var P in _)Object.prototype.hasOwnProperty.call(_,P)&&w.indexOf(P)<0&&(Ee[P]=_[P]);if(_!=null&&typeof Object.getOwnPropertySymbols=="function"){var ne=0;for(P=Object.getOwnPropertySymbols(_);ne<P.length;ne++)w.indexOf(P[ne])<0&&Object.prototype.propertyIsEnumerable.call(_,P[ne])&&(Ee[P[ne]]=_[P[ne]])}return Ee}(E,["allowReorder","status"]);return Object.assign(Object.assign({[F.AllowReorder]:T,[F.AbortController]:new AbortController,[F.Keys]:null,[F.Parent]:null,[F.Type]:d,[F.Data]:I},p&&{[F.Status]:p}),{children:null,key:m,output:null})}(e,r,s),i),a=ft.reconcile(o),c=Vn(),l=Object.is(a,o);Hn(a);const f=l?function(d,h,m){const E=zn(),T=lt(),p=jn(Object.assign({historyNode:d,runtimeNode:h},!E&&{runtimeRoot:h}),()=>{T(re.ISOLATE_ENTER,h);const I=m(h);return xe(I)?(T(re.ISOLATE_PENDING,h),I.then(_=>{er.isIsolate(_)&&W.addChild(h,_),T(re.ISOLATE_DONE,h)})):T(re.ISOLATE_DONE,h),I});return h.output=p,p}(c,o,n):a.output;return W.saveOutput(a,f),a}static isIsolate(e){return Je(e)&&e[F.Type]}};function Q(t,e,n){var r;let s=!1;if(!s){for(const o of(r=t.children)!==null&&r!==void 0?r:[])if(Q(o,(a,c)=>{e(a,()=>{c(),i()})},n),s)return;(C(n)||N(n,t))&&e(t,i)}function i(){s=!0}}function Wt(t,e,n){let r=!1;return Q(t,(s,i)=>{e(s)&&(i(),r=!0)},n),r}function Mt(t,e){let n=t;do{if(e(n))return n;n=n.parent}while(n);return null}var j=Object.freeze({__proto__:null,closest:Mt,closestExists:function(t,e){return!!Mt(t,e)},every:function(t,e,n){let r=!0;return Q(t,(s,i)=>{e(s)||(i(),r=!1)},n),r},find:function(t,e,n){let r=null;return Q(t,(s,i)=>{e(s)&&(i(),r=s)},n),r},findClosest:function(t,e){var n,r;let s=null,i=t;for(;i&&(s=(r=(n=i.children)===null||n===void 0?void 0:n.find(e))!==null&&r!==void 0?r:null,!s);)i=i.parent;return s},has:function(t,e){return Wt(t,()=>!0,e)},pluck:function(t,e,n){Q(t,r=>{e(r)&&r.parent&&W.removeChild(r.parent,r)},n)},reduce:function(t,e,n,r){let s=n;return Q(t,(i,o)=>{s=e(s,i,o)},r),s},some:Wt,walk:Q});const tr="Focused",ri="Group",si="OmitWhen",ii="SkipWhen",oi="Suite",nr="Test";class K{static setOptionalField(e,n,r){const s=e.data.optional,i=s[n];A(s,{[n]:A({},i,r(i))})}static getOptionalField(e,n){var r;return(r=K.getOptionalFields(e)[n])!==null&&r!==void 0?r:{}}static getOptionalFields(e){var n,r;return(r=(n=e.data)===null||n===void 0?void 0:n.optional)!==null&&r!==void 0?r:{}}}var Oe,Ie;(function(t){t[t.CUSTOM_LOGIC=0]="CUSTOM_LOGIC",t[t.AUTO=1]="AUTO"})(Oe||(Oe={})),function(t){t.EAGER="EAGER",t.ALL="ALL",t.ONE="ONE"}(Ie||(Ie={}));const k=vt((t,e)=>e?null:A({inclusion:{},mode:Be.createTinyState(Ie.EAGER),suiteParams:[],testMemoCache:ci},t));function ht(){return k.useX().inclusion}function ai(){return k.useX().mode()}const ci=Cn(10);function ui(t){var e;const n=S.useAvailableRoot(),r=k.useX().suiteParams,s=(e=r==null?void 0:r[0])!==null&&e!==void 0?e:{};if(De(t)||D(t))Rn(t).forEach(i=>{K.setOptionalField(n,i,()=>({type:Oe.AUTO,applied:!!we(s,i)&&kt.isBlank().test(s==null?void 0:s[i]),rule:null}))});else for(const i in t){const o=t[i];K.setOptionalField(n,i,()=>({type:Oe.CUSTOM_LOGIC,rule:o,applied:kt.isBlank().test(o)||o===!0}))}}function be(t){var e,n;if(!t)return!1;const r=S.useAvailableRoot();return(n=(e=K.getOptionalField(r,t))===null||e===void 0?void 0:e.applied)!==null&&n!==void 0&&n}var M;(function(t){t.HOOK_CALLED_OUTSIDE="hook called outside of a running suite.",t.EXPECTED_VEST_TEST="Expected value to be an instance of IsolateTest",t.FIELD_NAME_REQUIRED="Field name must be passed",t.SUITE_MUST_BE_INITIALIZED_WITH_FUNCTION="Suite must be initialized with a function",t.PROMISIFY_REQUIRE_FUNCTION="Vest.Promisify must be called with a function",t.PARSER_EXPECT_RESULT_OBJECT="Vest parser: expected argument at position 0 to be Vest's result object.",t.WARN_MUST_BE_CALLED_FROM_TEST="Warn must be called from within the body of a test function",t.EACH_CALLBACK_MUST_BE_A_FUNCTION="Each must be called with a function",t.INVALID_PARAM_PASSED_TO_FUNCTION='Incompatible params passed to {fn_name} function. "{param}" must be of type {expected}',t.TESTS_CALLED_IN_DIFFERENT_ORDER=`Vest Critical Error: Tests called in different order than previous run.
    expected: {fieldName}
    received: {prevName}
    This can happen on one of two reasons:
    1. You're using if/else statements to conditionally select tests. Instead, use "skipWhen".
    2. You are iterating over a list of tests, and their order changed. Use "each" and a custom key prop so that Vest retains their state.`,t.UNEXPECTED_TEST_REGISTRATION_ERROR=`Unexpected error encountered during test registration.
      Please report this issue to Vest's Github repository.
      Test Object: {testObject}.
      Error: {error}.`,t.UNEXPECTED_TEST_RUN_ERROR=`Unexpected error encountered during test run. Please report this issue to Vest's Github repository.
      Test Object: {testObject}.`,t.INCLUDE_SELF="Trying to call include.when on the same field."})(M||(M={}));const le="PENDING",pt="INITIAL",gt="DONE",x={[le]:le,[pt]:pt,[gt]:gt},li=In({initial:x.INITIAL,states:{[x.DONE]:{},[x.INITIAL]:{[x.PENDING]:x.PENDING,[x.DONE]:x.DONE},[x.PENDING]:{[x.DONE]:x.DONE}}}),g={[le]:le,CANCELED:"CANCELED",FAILED:"FAILED",OMITTED:"OMITTED",PASSING:"PASSING",SKIPPED:"SKIPPED",UNTESTED:"UNTESTED",WARNING:"WARNING"},rr="RESET",sr=In({initial:g.UNTESTED,states:{"*":{[g.OMITTED]:g.OMITTED,[rr]:g.UNTESTED},[g.UNTESTED]:{[g.CANCELED]:g.CANCELED,[g.FAILED]:g.FAILED,[g.PASSING]:g.PASSING,[g.PENDING]:g.PENDING,[g.SKIPPED]:g.SKIPPED,[g.WARNING]:g.WARNING},[g.PENDING]:{[g.CANCELED]:g.CANCELED,[g.FAILED]:g.FAILED,[g.PASSING]:g.PASSING,[g.SKIPPED]:[g.SKIPPED,t=>t===!0],[g.WARNING]:g.WARNING},[g.SKIPPED]:{},[g.FAILED]:{},[g.WARNING]:{},[g.PASSING]:{},[g.CANCELED]:{},[g.OMITTED]:{}}});var L,z,Ae,de;function ir(t){return t===L.ERRORS?z.ERROR_COUNT:z.WARN_COUNT}(function(t){t.WARNINGS="warnings",t.ERRORS="errors"})(L||(L={})),function(t){t.ERROR_COUNT="errorCount",t.WARN_COUNT="warnCount"}(z||(z={})),function(t){t.Error="error",t.Warning="warning"}(Ae||(Ae={}));class V{static getStatus(e){var n;return(n=e.status)!==null&&n!==void 0?n:pt}static setStatus(e,n,r){e.status=this.stateMachine.staticTransition(V.getStatus(e),n,r)}static statusEquals(e,n){return V.getStatus(e)===n}static setPending(e){this.setStatus(e,le)}static setDone(e){this.setStatus(e,gt)}static isPending(e){return V.statusEquals(e,le)}}V.stateMachine=li;class u extends V{static getData(e){return O(e.data),e.data}static is(e){return Qn.isIsolateType(e,nr)}static isX(e){O(u.is(e),M.EXPECTED_VEST_TEST)}static cast(e){return u.isX(e),e}static warns(e){return u.getData(e).severity===Ae.Warning}static isOmitted(e){return u.statusEquals(e,g.OMITTED)}static isUntested(e){return u.statusEquals(e,g.UNTESTED)}static isFailing(e){return u.statusEquals(e,g.FAILED)}static isCanceled(e){return u.statusEquals(e,g.CANCELED)}static isSkipped(e){return u.statusEquals(e,g.SKIPPED)}static isPassing(e){return u.statusEquals(e,g.PASSING)}static isWarning(e){return u.statusEquals(e,g.WARNING)}static hasFailures(e){return u.isFailing(e)||u.isWarning(e)}static isNonActionable(e){return u.isSkipped(e)||u.isOmitted(e)||u.isCanceled(e)}static isTested(e){return u.hasFailures(e)||u.isPassing(e)}static awaitsResolution(e){return u.isSkipped(e)||u.isUntested(e)||u.isPending(e)}static isAsyncTest(e){return xe(u.getData(e).asyncTest)}static fail(e){u.setStatus(e,u.warns(e)?g.WARNING:g.FAILED)}static pass(e){u.setStatus(e,g.PASSING)}static warn(e){u.setData(e,n=>Object.assign(Object.assign({},n),{severity:Ae.Warning}))}static setData(e,n){e.data=N(n,u.getData(e))}static skip(e,n){u.setStatus(e,g.SKIPPED,n)}static cancel(e){u.setStatus(e,g.CANCELED),W.abort(e,g.CANCELED)}static omit(e){u.setStatus(e,g.OMITTED)}static reset(e){u.setStatus(e,rr)}}function Ye(t,e){return!!e&&!fe(t,e)}function fe(t,e){return!(!e||t.fieldName!==e)}function or(t,e){const{groupName:n}=u.getData(t),{groupName:r,fieldName:s}=u.getData(e);return fe(u.getData(t),s)&&n===r&&t.key==e.key}function ar(t,e){return ge.create(tr,Ds,{focusMode:t,match:Rn(e).filter(D),matchAll:e===!0})}u.stateMachine=sr,function(t){t[t.ONLY=0]="ONLY",t[t.SKIP=1]="SKIP"}(de||(de={}));class Se{static isSkipFocused(e,n){return(e==null?void 0:e.data.focusMode)===de.SKIP&&(xt(e,n)||e.data.matchAll===!0)}static isOnlyFocused(e,n){return(e==null?void 0:e.data.focusMode)===de.ONLY&&xt(e,n)}static isIsolateFocused(e){return Qn.isIsolateType(e,tr)}}function di(t){return ar(de.ONLY,cr(t))}function fi(t){return ar(de.SKIP,cr(t))}function cr(t){return t===!1?[]:t}function xt(t,e){var n,r;return On(t==null?void 0:t.data.match)&&(!e||(r=(n=t==null?void 0:t.data.match)===null||n===void 0?void 0:n.includes(e))===null||r===void 0||r)}const hi=Cn();function he(){return S.useXAppData()}function St(){return he().doneCallbacks()}function Ct(){return he().fieldCallbacks()}function Rt(){return he().suiteId}function ur(){he().suiteResultCache.invalidate([Rt()])}function Bt(){const[,,t]=St(),[,,e]=Ct();t(),e()}function pi(t){S.useLoadRootNode(t),ur()}function lr(t,e,n){return n?function(r,s,i){var o;return((o=r==null?void 0:r[i])===null||o===void 0?void 0:o[s])||[]}(t,e,n):function(r,s){const i={},o=ir(s);for(const a in r)q(r[a][o])&&(i[a]=r[a][s]||[]);return i}(t,e)}function dr(t){return{getError:r,getErrors:function(s){return Gt(t,L.ERRORS,s)},getErrorsByGroup:function(s,i){return jt(t,L.ERRORS,s,i)},getMessage:function(s){return r(s)||n(s)},getWarning:n,getWarnings:function(s){return Gt(t,L.WARNINGS,s)},getWarningsByGroup:function(s,i){return jt(t,L.WARNINGS,s,i)},hasErrors:function(s){return Vt(t,z.ERROR_COUNT,s)},hasErrorsByGroup:function(s,i){return Kt(t,z.ERROR_COUNT,s,i)},hasWarnings:function(s){return Vt(t,z.WARN_COUNT,s)},hasWarningsByGroup:function(s,i){return Kt(t,z.WARN_COUNT,s,i)},isPending:function(s){var i;return ae(s?(i=t.tests[s])===null||i===void 0?void 0:i.pendingCount:t.pendingCount,0)},isTested:function(s){var i;return q((i=t.tests[s])===null||i===void 0?void 0:i.testCount)},isValid:function(s){var i;return!!(s?!((i=t.tests[s])===null||i===void 0)&&i.valid:t.valid)},isValidByGroup:function(s,i){const o=t.groups[s];if(!o)return!1;if(i)return qt(o,i);for(const a in o)if(!qt(o,a))return!1;return!0}};function n(s){return Ht(L.WARNINGS,t,s)}function r(s){return Ht(L.ERRORS,t,s)}}function Gt(t,e,n){return lr(t.tests,e,n)}function jt(t,e,n,r){return lr(t.groups[n],e,r)}function qt(t,e){var n;return!!(!((n=t[e])===null||n===void 0)&&n.valid)}function Kt(t,e,n,r){var s,i;const o=t.groups[n];if(!o)return!1;if(r)return q((s=o[r])===null||s===void 0?void 0:s[e]);for(const a in o)if(q((i=o[a])===null||i===void 0?void 0:i[e]))return!0;return!1}function Vt(t,e,n){var r;const s=n?(r=t.tests[n])===null||r===void 0?void 0:r[e]:t[e]||0;return q(s)}function Ht(t,e,n){var r;const s=e[t];return n?(r=s.find(i=>fe(i,n)))===null||r===void 0?void 0:r.message:s[0]}var fr,hr;class pr{constructor(){this.errorCount=0,this.warnCount=0,this.testCount=0,this.pendingCount=0}}class gi extends pr{constructor(){super(...arguments),this[fr]=[],this[hr]=[],this.groups={},this.tests={},this.valid=null}}fr=L.ERRORS,hr=L.WARNINGS;class Ke{constructor(e,n,r){this.fieldName=e,this.message=n,this.groupName=r}static fromTestObject(e){const{fieldName:n,message:r,groupName:s}=u.getData(e);return new Ke(n,r,s)}}class v{static hasNoTests(e=v.defaultRoot()){return!e||!j.has(e,u.is)}static someTests(e,n=v.defaultRoot()){return!!n&&j.some(n,r=>(u.isX(r),e(r)),u.is)}static everyTest(e,n=v.defaultRoot()){return!!n&&j.every(n,r=>(u.isX(r),e(r)),u.is)}static walkTests(e,n=v.defaultRoot()){n&&j.walk(n,(r,s)=>{e(u.cast(r),s)},u.is)}static reduceTests(e,n,r=v.defaultRoot()){return r?j.reduce(r,(s,i,o)=>e(s,u.cast(i),o),n,u.is):n}static pluckTests(e,n=v.defaultRoot()){n&&j.pluck(n,r=>(u.isX(r),e(r)),u.is)}static resetField(e){v.walkTests(n=>{fe(u.getData(n),e)&&u.reset(n)},v.defaultRoot())}static removeTestByFieldName(e,n=v.defaultRoot()){v.pluckTests(r=>fe(u.getData(r),e),n)}}v.defaultRoot=S.useAvailableRoot;class H{static hasPending(e){const n=H.defaultRoot();return!!n&&j.some(n,ye.all(V.isPending,e==null||e))}static hasRemainingWithTestNameMatching(e){return H.hasPending(ye.any(C(e),ye.all(u.is,n=>function(r,s){return!s||fe(r,s)}(u.getData(n),e))))}}H.defaultRoot=S.useAvailableRoot;const ot=y(function(t,e){return u.getData(t).groupName===e});function Et(t){return function(e,n){return v.someTests(r=>gr(r,e,n))}(L.ERRORS,t)}function gr(t,e,n){return!!u.hasFailures(t)&&!Ye(u.getData(t),n)&&!function(r,s){return Rs(r===L.WARNINGS,u.warns(s))}(e,t)}function Xt(t){return!!be(t)||!v.hasNoTests()&&!Et(t)&&!function(e){return H.hasPending(ye.all(u.is,n=>!Ye(u.getData(n),e),()=>!be(e)))}(t)&&function(e){return v.everyTest(n=>Er(n,e))}(t)}function Ei(t,e){return!!be(e)||!function(n,r,s){return v.someTests(i=>!ot(i,r)&&gr(i,n,s))}(L.ERRORS,t,e)&&!function(n,r){return H.hasPending(ye.all(u.is,s=>!ot(s,n),s=>!Ye(u.getData(s),r),()=>!be(r)))}(t,e)&&function(n,r){return v.everyTest(s=>!!ot(s,n)||Er(s,r))}(t,e)}function Er(t,e){return!!Ye(u.getData(t),e)||u.isOmitted(t)||u.isTested(t)||function(n){const r=S.useAvailableRoot(),{fieldName:s}=u.getData(n);return K.getOptionalField(r,s).type===Oe.AUTO&&u.awaitsResolution(n)}(t)}function mi(){const t=v.reduceTests((e,n)=>{const r=u.getData(n).fieldName;return e.tests[r]=function(s,i){const o=u.getData(i).fieldName,a=zt(s[o],i);return a.valid=a.valid!==!1&&Xt(o),a}(e.tests,n),e.groups=function(s,i){const{groupName:o,fieldName:a}=u.getData(i);if(!o)return s;s[o]=s[o]||{};const c=s[o];return c[a]=zt(c[a],i),c[a].valid=c[a].valid!==!1&&Ei(o,a),s}(e.groups,n),u.isOmitted(n)?e:(e.tests[r].valid===!1&&(e.valid=!1),function(s,i){return u.isWarning(s)?(i.warnCount++,i.warnings.push(Ke.fromTestObject(s))):u.isFailing(s)&&(i.errorCount++,i.errors.push(Ke.fromTestObject(s))),u.isPending(s)&&i.pendingCount++,u.isNonActionable(s)||i.testCount++,i}(n,e))},new gi);return t.valid=t.valid!==!1&&Xt(),t}function zt(t,e){const{message:n}=u.getData(e),r=Nt(t?Object.assign({},t):null,Ti);return u.isNonActionable(e)||(u.isPending(e)&&r.pendingCount++,u.isFailing(e)?s(L.ERRORS):u.isWarning(e)&&s(L.WARNINGS),r.testCount++),r;function s(i){const o=ir(i);r[o]++,n&&(r[i]=(r[i]||[]).concat(n))}}function Ti(){return A(new pr,{errors:[],valid:!0,warnings:[]})}function te(){return t=()=>{const e=mi(),n=he().suiteName;return Object.freeze(A(e,dr(e),{suiteName:n}))},(0,he().suiteResultCache)([Rt()],t);var t}function wi(t,e){ge.create(ii,()=>{k.run({skipped:_t()||N(t,N(te))},e)})}function _t(){return function(){var t;return(t=k.useX().skipped)!==null&&t!==void 0&&t}()}function mr(t,e){return Je(j.findClosest(t,n=>!!Se.isIsolateFocused(n)&&Se.isOnlyFocused(n,e)))}function Tr(t){const{fieldName:e}=u.getData(t);if(_t())return!0;const n=ht(),r=function(s){return j.findClosest(s,i=>{var o;if(!Se.isIsolateFocused(i))return!1;const{fieldName:a}=u.getData(s);return((o=i.data.match)===null||o===void 0?void 0:o.includes(a))||i.data.matchAll})}(t);return Se.isSkipFocused(r)?!0:!Se.isOnlyFocused(r)&&!!mr(t)&&!N(n[e],t)}function Jt(t){const[e]=ai();return e===t}function Ni(t){return Jt(Ie.ONE)?Et():!!Jt(Ie.EAGER)&&Et(t.fieldName)}function yi(t,e){ge.create(si,()=>{k.run({omitted:wr()||N(t,N(te))},e)})}function wr(){return function(){var t;return(t=k.useX().omitted)!==null&&t!==void 0&&t}()}function Nr(t,e=t){const n=u.getData(t);return Ni(n)?(r=t,u.skip(r),r):(s=n.fieldName,wr()||be(s)?function(i){return u.omit(i),i}(t):Tr(t)?function(i){return u.skip(i,_t()),i}(e):t);var r,s}function vi(t,e){return u.is(e)&&!or(e,t)}const Si=[class{static match(t,e){return u.is(t)&&u.is(e)}static reconcile(t,e){const n=Nr(t,function(r,s){return $.usesKey(r)?function(i){return u.cast(ft.handleIsolateNodeWithKey(i,o=>!!u.isNonActionable(o)||!Tr(i)))}(r):ft.dropNextNodesOnReorder(vi,r,s)?(function(i,o){$.canReorder(i)||yt(ue(M.TESTS_CALLED_IN_DIFFERENT_ORDER,{fieldName:u.getData(i).fieldName,prevName:u.is(o)?u.getData(o).fieldName:void 0}))}(r,s),r):!u.is(s)||u.isOmitted(s)?r:s}(t,e));return function(r,s,i){r===s&&u.is(s)&&(a=s)!==(o=i)&&or(o,a)&&u.isPending(o)&&u.cancel(o);var o,a}(n,t,e),n}}];function Ci(t,e){var n,r;return(r=(n=Si.find(s=>s.match(t,e)))===null||n===void 0?void 0:n.reconcile(t,e))!==null&&r!==void 0?r:null}function Ri(...t){const[e,n]=t.reverse();return ge.create(ri,()=>k.run(Object.assign({},n&&{groupName:n}),e))}function _i(t){return O(D(t)),ht()[t]=!0,{when:function(e){O(e!==t,M.INCLUDE_SELF),ht()[t]=function(n){return D(e)?mr(n,e):N(e,N(te))}}}}var R;function Oi(t,e,n){const r=Object.assign(Object.assign({},{severity:Ae.Error,status:sr.initial()}),{fieldName:e.fieldName,testFn:e.testFn});return e.groupName&&(r.groupName=e.groupName),e.message&&(r.message=e.message),ge.create(nr,t,r,n??null)}function Ii(t){if(Nr(t),u.isUntested(t))return function(e){const n=function(r){return k.run({currentTest:r},()=>{let s;const{message:i,testFn:o}=u.getData(r);try{s=o({signal:r.abortController.signal})}catch(a){(function(c,l){return ze(c)&&D(l)})(i,a)&&(u.getData(r).message=a),s=!1}return s===!1&&u.fail(r),s})}(e);try{if(xe(n))return u.getData(e).asyncTest=n,function(r){const{asyncTest:s,message:i}=u.getData(r);if(!xe(s))return;const o=S.persist(()=>{Yt(r)}),a=S.persist(c=>{u.isCanceled(r)||(u.getData(r).message=D(c)?c:i,u.fail(r),o())});return s.then(o,a)}(e);Yt(e)}catch(r){throw new Error(ue(M.UNEXPECTED_TEST_REGISTRATION_ERROR,{testObject:JSON.stringify(e),error:r}))}}(t);u.isNonActionable(t)||yt(ue(M.UNEXPECTED_TEST_REGISTRATION_ERROR,{testObject:JSON.stringify(t)}))}function Yt(t){u.pass(t)}function Qt(t,...e){const[n,r,s]=Z(e[1])?e:[void 0,...e];(function(o,a){const c="test";O(D(o),ue(M.INVALID_PARAM_PASSED_TO_FUNCTION,{fn_name:c,param:"fieldName",expected:"string"})),O(Z(a),ue(M.INVALID_PARAM_PASSED_TO_FUNCTION,{fn_name:c,param:"callback",expected:"function"}))})(t,r);const i={fieldName:t,groupName:k.useX().groupName,message:n,testFn:r};return X.useEmit(R.TEST_RUN_STARTED),Oi(Ii,i,s)}(function(t){t.TEST_RUN_STARTED="test_run_started",t.TEST_COMPLETED="test_completed",t.ALL_RUNNING_TESTS_FINISHED="all_running_tests_finished",t.REMOVE_FIELD="remove_field",t.RESET_FIELD="reset_field",t.RESET_SUITE="reset_suite",t.SUITE_RUN_STARTED="suite_run_started",t.SUITE_CALLBACK_RUN_FINISHED="SUITE_CALLBACK_RUN_FINISHED",t.DONE_TEST_OMISSION_PASS="DONE_TEST_OMISSION_PASS"})(R||(R={}));const bi=A(Qt,{memo:function(t){return function(e,...n){const[r,s,i]=n.reverse();return function(o,a){const c=k.useX().testMemoCache,l=c.get(o);if(Xe(l))return c(o,a);const[,f]=l;return u.isCanceled(f)?(c.invalidate(o),c(o,a)):(S.addNodeToHistory(f),f)}([Rt(),e,S.useCurrentCursor()].concat(r),function(){return t(e,i,s)})}}(Qt)});function yr(){return{group:Ri,include:_i,omitWhen:yi,only:di,optional:ui,skip:fi,skipWhen:wi,test:bi}}function Zt(){const t=S.useAvailableRoot(),e=K.getOptionalFields(t);if(ce(e))return;const n=new Set;function r(s){const{fieldName:i}=u.getData(s);n.has(i)&&(u.omit(s),K.setOptionalField(t,i,o=>Object.assign(Object.assign({},o),{applied:!0})))}v.walkTests(s=>{if(u.isPending(s))return;const{fieldName:i}=u.getData(s);n.has(i)?r(s):function(o){const{fieldName:a}=u.getData(o),c=K.getOptionalField(t,a);N(c.rule)===!0&&n.add(a),r(o)}(s)}),X.useEmit(R.DONE_TEST_OMISSION_PASS)}function Ai(){const t=X.useBus();return e(R.TEST_COMPLETED,n=>{if(u.isCanceled(n))return;const{fieldName:r}=u.getData(n);(function(s){const[i]=Ct();s&&!H.hasRemainingWithTestNameMatching(s)&&De(i[s])&&Ut(i[s])})(r)}),e(R.TEST_RUN_STARTED,()=>{}),e(re.ISOLATE_PENDING,n=>{u.is(n)&&u.setPending(n),V.setPending(n)}),e(re.ISOLATE_DONE,n=>{u.is(n)&&t.emit(R.TEST_COMPLETED,n),V.setDone(n),H.hasPending()||t.emit(R.ALL_RUNNING_TESTS_FINISHED)}),e(R.DONE_TEST_OMISSION_PASS,()=>{}),e(R.ALL_RUNNING_TESTS_FINISHED,()=>{v.someTests(u.isAsyncTest)&&Zt(),function(){const[n]=St();Ut(n)}()}),e(R.RESET_FIELD,n=>{v.resetField(n)}),e(R.SUITE_RUN_STARTED,()=>{Bt()}),e(R.SUITE_CALLBACK_RUN_FINISHED,()=>{Zt()}),e(R.REMOVE_FIELD,n=>{v.removeTestByFieldName(n)}),e(R.RESET_SUITE,()=>{Bt(),S.reset()}),{subscribe:function(n){return t.on("*",()=>{n()}).off}};function e(n,r){t.on(n,(...s)=>{ur(),r(...s)})}}function vr(){return Object.freeze(A({done:S.persist(Di)},te()))}function Di(...t){const[e,n]=t.reverse(),r=vr();if(function(i,o,a){var c,l;return!!(!Z(i)||o&&pe((l=(c=a.tests[o])===null||c===void 0?void 0:c.testCount)!==null&&l!==void 0?l:0,0))}(e,n,r))return r;const s=()=>e(te());return H.hasRemainingWithTestNameMatching(n)?(function(i,o){const[,a]=Ct(),[,c]=St();o?a(l=>A(l,{[o]:(l[o]||[]).concat(i)})):c(l=>l.concat(i))}(s,n),r):(s(),r)}function Pi(...t){const[e,n]=t.reverse();(function(o){O(Z(o),M.SUITE_MUST_BE_INITIALIZED_WITH_FUNCTION)})(e);const r=function({suiteName:o,VestReconciler:a}){const c={doneCallbacks:Be.createTinyState(()=>[]),fieldCallbacks:Be.createTinyState(()=>({})),suiteId:Os(),suiteName:o,suiteResultCache:hi};return S.createRef(a,c)}({suiteName:n,VestReconciler:Ci});function s(...o){return k.run({suiteParams:o},()=>{return X.useEmit(R.SUITE_RUN_STARTED),a=function(c,...l){const f=X.useEmit();return()=>(c(...l),f(R.SUITE_CALLBACK_RUN_FINISHED),vr())}(e,...o),ge.create(oi,a,{optional:{}});var a}).output}const i=Li(...t);return S.Run(r,()=>{const o=Ai();return A(S.persist(s),Object.assign(Object.assign({dump:S.persist(()=>S.useAvailableRoot()),get:S.persist(te),remove:X.usePrepareEmitter(R.REMOVE_FIELD),reset:X.usePrepareEmitter(R.RESET_SUITE),resetField:X.usePrepareEmitter(R.RESET_FIELD),resume:S.persist(pi),runStatic:(...c)=>i(...c),subscribe:o.subscribe},(a=S.persist(te),{getError:(...c)=>a().getError(...c),getErrors:(...c)=>a().getErrors(...c),getErrorsByGroup:(...c)=>a().getErrorsByGroup(...c),getMessage:(...c)=>a().getMessage(...c),getWarning:(...c)=>a().getWarning(...c),getWarnings:(...c)=>a().getWarnings(...c),getWarningsByGroup:(...c)=>a().getWarningsByGroup(...c),hasErrors:(...c)=>a().hasErrors(...c),hasErrorsByGroup:(...c)=>a().hasErrorsByGroup(...c),hasWarnings:(...c)=>a().hasWarnings(...c),hasWarningsByGroup:(...c)=>a().hasWarningsByGroup(...c),isPending:(...c)=>a().isPending(...c),isTested:(...c)=>a().isTested(...c),isValid:(...c)=>a().isValid(...c),isValidByGroup:(...c)=>a().isValidByGroup(...c)})),yr()));var a})}function Li(...t){return A((...e)=>{const n=Pi(...t),r=n(...e);return Object.freeze(A({dump:n.dump},r))},Object.assign({},yr()))}M.WARN_MUST_BE_CALLED_FROM_TEST;var mt;function zi(t,e={}){const n=function(r){O(r&&we(r,"valid"),mt.PARSER_EXPECT_RESULT_OBJECT);const s=dr(r),i={},o={invalid:s.hasErrors,pending:s.isPending,tested:function(c){return C(c)?q(r.testCount):we(i,c)?i[c]:(a(c),o.tested(c))},untested:function(c){return!(q(r.testCount)&&o.tested(c))},valid:s.isValid,warning:s.hasWarnings};return o;function a(c){i[c]=we(r.tests,c)&&q(r.tests[c].testCount)}}(t);return function(r){const s=[];for(const i in e){const o=i;Z(n[o])&&n[o](r)&&s.push(e[o])}return s.join(" ")}}(function(t){t.HOOK_CALLED_OUTSIDE="hook called outside of a running suite.",t.EXPECTED_VEST_TEST="Expected value to be an instance of IsolateTest",t.FIELD_NAME_REQUIRED="Field name must be passed",t.SUITE_MUST_BE_INITIALIZED_WITH_FUNCTION="Suite must be initialized with a function",t.PROMISIFY_REQUIRE_FUNCTION="Vest.Promisify must be called with a function",t.PARSER_EXPECT_RESULT_OBJECT="Vest parser: expected argument at position 0 to be Vest's result object.",t.WARN_MUST_BE_CALLED_FROM_TEST="Warn must be called from within the body of a test function",t.EACH_CALLBACK_MUST_BE_A_FUNCTION="Each must be called with a function",t.INVALID_PARAM_PASSED_TO_FUNCTION='Incompatible params passed to {fn_name} function. "{param}" must be of type {expected}',t.TESTS_CALLED_IN_DIFFERENT_ORDER=`Vest Critical Error: Tests called in different order than previous run.
    expected: {fieldName}
    received: {prevName}
    This can happen on one of two reasons:
    1. You're using if/else statements to conditionally select tests. Instead, use "skipWhen".
    2. You are iterating over a list of tests, and their order changed. Use "each" and a custom key prop so that Vest retains their state.`,t.UNEXPECTED_TEST_REGISTRATION_ERROR=`Unexpected error encountered during test registration.
      Please report this issue to Vest's Github repository.
      Test Object: {testObject}.
      Error: {error}.`,t.UNEXPECTED_TEST_RUN_ERROR=`Unexpected error encountered during test run. Please report this issue to Vest's Github repository.
      Test Object: {testObject}.`,t.INCLUDE_SELF="Trying to call include.when on the same field."})(mt||(mt={}));function Ui(t){let e,n,r;return{c(){e=Qe("svg"),n=Qe("circle"),r=Qe("path"),this.h()},l(s){e=Ze(s,"svg",{class:!0,xmlns:!0,fill:!0,viewBox:!0});var i=se(e);n=Ze(i,"circle",{class:!0,cx:!0,cy:!0,r:!0,stroke:!0,"stroke-width":!0}),se(n).forEach(B),r=Ze(i,"path",{class:!0,fill:!0,d:!0}),se(r).forEach(B),i.forEach(B),this.h()},h(){U(n,"class","opacity-25"),U(n,"cx","12"),U(n,"cy","12"),U(n,"r","10"),U(n,"stroke","currentColor"),U(n,"stroke-width","4"),U(r,"class","opacity-75"),U(r,"fill","currentColor"),U(r,"d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"),U(e,"class","animate-spin text-gray-950"),U(e,"xmlns","http://www.w3.org/2000/svg"),U(e,"fill","none"),U(e,"viewBox","0 0 24 24")},m(s,i){He(s,e,i),Ce(e,n),Ce(e,r)},p:Te,i:Te,o:Te,d(s){s&&B(e)}}}class Ji extends un{constructor(e){super(),ln(this,e,null,Ui,cn,{})}}async function Yi(t){if(t instanceof wn){const e=await t.response.json();if(e)return Fi(e),e}throw console.error(t),on(`${We(at).errors.name.internal()}: ${We(at).errors.message.application()}`),t}async function Fi(t){const e=We(at);for(const[n,r]of Object.entries(t.errors))for(const s of r){const i=e.errors.name[n](),o=e.errors.message[s.error](...s.parameters);on(`${i}: ${o}`)}}function en(t,e,n){const r=t.slice();return r[2]=e[n],r}function tn(t,e,n){const r=t.slice();return r[5]=e[n],r}function nn(t){let e,n=t[5]+"",r;return{c(){e=Tt("li"),r=dn(n),this.h()},l(s){e=wt(s,"LI",{class:!0});var i=se(e);r=fn(i,n),i.forEach(B),this.h()},h(){U(e,"class","text-sm text-red-600")},m(s,i){He(s,e,i),Ce(e,r)},p(s,i){i&3&&n!==(n=s[5]+"")&&hn(r,n)},d(s){s&&B(e)}}}function rn(t){let e,n=t[2]+"",r;return{c(){e=Tt("li"),r=dn(n),this.h()},l(s){e=wt(s,"LI",{class:!0});var i=se(e);r=fn(i,n),i.forEach(B),this.h()},h(){U(e,"class","text-sm text-orange-600")},m(s,i){He(s,e,i),Ce(e,r)},p(s,i){i&3&&n!==(n=s[2]+"")&&hn(r,n)},d(s){s&&B(e)}}}function $i(t){let e,n,r=Pe(t[0].getErrors(t[1])),s=[];for(let a=0;a<r.length;a+=1)s[a]=nn(tn(t,r,a));let i=Pe(t[0].getWarnings(t[1])),o=[];for(let a=0;a<i.length;a+=1)o[a]=rn(en(t,i,a));return{c(){e=Tt("ul");for(let a=0;a<s.length;a+=1)s[a].c();n=Dr();for(let a=0;a<o.length;a+=1)o[a].c()},l(a){e=wt(a,"UL",{});var c=se(e);for(let l=0;l<s.length;l+=1)s[l].l(c);n=Pr(c);for(let l=0;l<o.length;l+=1)o[l].l(c);c.forEach(B)},m(a,c){He(a,e,c);for(let l=0;l<s.length;l+=1)s[l]&&s[l].m(e,null);Ce(e,n);for(let l=0;l<o.length;l+=1)o[l]&&o[l].m(e,null)},p(a,[c]){if(c&3){r=Pe(a[0].getErrors(a[1]));let l;for(l=0;l<r.length;l+=1){const f=tn(a,r,l);s[l]?s[l].p(f,c):(s[l]=nn(f),s[l].c(),s[l].m(e,n))}for(;l<s.length;l+=1)s[l].d(1);s.length=r.length}if(c&3){i=Pe(a[0].getWarnings(a[1]));let l;for(l=0;l<i.length;l+=1){const f=en(a,i,l);o[l]?o[l].p(f,c):(o[l]=rn(f),o[l].c(),o[l].m(e,null))}for(;l<o.length;l+=1)o[l].d(1);o.length=i.length}},i:Te,o:Te,d(a){a&&B(e),Ot(s,a),Ot(o,a)}}}function ki(t,e,n){let{result:r}=e,{name:s}=e;return t.$$set=i=>{"result"in i&&n(0,r=i.result),"name"in i&&n(1,s=i.name)},[r,s]}class Qi extends un{constructor(e){super(),ln(this,e,ki,$i,cn,{result:0,name:1})}}export{ms as A,Tn as C,Qi as I,yi as N,di as O,Ji as S,zi as a,Pi as b,rs as c,bi as d,ws as e,ss as f,Xi as g,Yi as h,es as i,Hi as j,Vi as k,qr as l,kt as v};
